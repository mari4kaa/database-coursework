<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Реалізація інформаційного та програмного забезпечення | 4. Система управління проектами</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/database-coursework/favicon.ico">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <meta name="description" content="Курсова робота з дисципліни &quot;Бази даних&quot;">
    
    <link rel="preload" href="/database-coursework/assets/css/0.styles.07799b51.css" as="style"><link rel="preload" href="/database-coursework/assets/js/app.3c640ca0.js" as="script"><link rel="preload" href="/database-coursework/assets/js/2.84bc8c61.js" as="script"><link rel="preload" href="/database-coursework/assets/js/1.3844ea3f.js" as="script"><link rel="preload" href="/database-coursework/assets/js/38.2ca837a5.js" as="script"><link rel="prefetch" href="/database-coursework/assets/js/10.aaa6304b.js"><link rel="prefetch" href="/database-coursework/assets/js/13.36d4ab52.js"><link rel="prefetch" href="/database-coursework/assets/js/14.ad6f7787.js"><link rel="prefetch" href="/database-coursework/assets/js/15.dc7330b2.js"><link rel="prefetch" href="/database-coursework/assets/js/16.f5957e90.js"><link rel="prefetch" href="/database-coursework/assets/js/17.8d500ec9.js"><link rel="prefetch" href="/database-coursework/assets/js/18.aef473c8.js"><link rel="prefetch" href="/database-coursework/assets/js/19.f18a3f78.js"><link rel="prefetch" href="/database-coursework/assets/js/20.106ba7c0.js"><link rel="prefetch" href="/database-coursework/assets/js/21.c88a9ae9.js"><link rel="prefetch" href="/database-coursework/assets/js/22.ad07a126.js"><link rel="prefetch" href="/database-coursework/assets/js/23.7279c42d.js"><link rel="prefetch" href="/database-coursework/assets/js/24.6e887fa1.js"><link rel="prefetch" href="/database-coursework/assets/js/25.b48850fb.js"><link rel="prefetch" href="/database-coursework/assets/js/26.75d636b7.js"><link rel="prefetch" href="/database-coursework/assets/js/27.eac39d19.js"><link rel="prefetch" href="/database-coursework/assets/js/28.53285346.js"><link rel="prefetch" href="/database-coursework/assets/js/29.333f03a6.js"><link rel="prefetch" href="/database-coursework/assets/js/3.693a1b30.js"><link rel="prefetch" href="/database-coursework/assets/js/30.e2bc30eb.js"><link rel="prefetch" href="/database-coursework/assets/js/31.3d5939e4.js"><link rel="prefetch" href="/database-coursework/assets/js/32.96cc09e9.js"><link rel="prefetch" href="/database-coursework/assets/js/33.d930f828.js"><link rel="prefetch" href="/database-coursework/assets/js/34.fd9ec551.js"><link rel="prefetch" href="/database-coursework/assets/js/35.b13fef70.js"><link rel="prefetch" href="/database-coursework/assets/js/36.b7afc933.js"><link rel="prefetch" href="/database-coursework/assets/js/37.7e374134.js"><link rel="prefetch" href="/database-coursework/assets/js/39.0850f27e.js"><link rel="prefetch" href="/database-coursework/assets/js/4.36acaae9.js"><link rel="prefetch" href="/database-coursework/assets/js/40.1c5a25c4.js"><link rel="prefetch" href="/database-coursework/assets/js/41.8467d1f8.js"><link rel="prefetch" href="/database-coursework/assets/js/5.71d445e8.js"><link rel="prefetch" href="/database-coursework/assets/js/6.3d09d4c0.js"><link rel="prefetch" href="/database-coursework/assets/js/7.8cdd77c8.js"><link rel="prefetch" href="/database-coursework/assets/js/8.583b0f46.js"><link rel="prefetch" href="/database-coursework/assets/js/9.4185eaa5.js"><link rel="prefetch" href="/database-coursework/assets/js/vendors~docsearch.8bdb2884.js">
    <link rel="stylesheet" href="/database-coursework/assets/css/0.styles.07799b51.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/database-coursework/" class="home-link router-link-active"><!----> <span class="site-name">4. Система управління проектами</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/database-coursework/" class="nav-link">
  Початок
</a></div> <a href="https://github.com/kol-oss/database-coursework" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/database-coursework/" class="nav-link">
  Початок
</a></div> <a href="https://github.com/kol-oss/database-coursework" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/database-coursework/intro/" class="sidebar-link">Вступ</a></li><li><section class="sidebar-group collapsable depth-0"><a href="/database-coursework/requirements/" class="sidebar-heading clickable"><span>Розроблення загальних вимог до системи</span> <span class="arrow right"></span></a> <!----></section></li><li><a href="/database-coursework/use%20cases/" class="sidebar-link">Розроблення вимог до функціональности системи</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/database-coursework/use%20cases/#загальна-схема" class="sidebar-link">Загальна схема</a></li><li class="sidebar-sub-header"><a href="/database-coursework/use%20cases/#звичаинии-користувач" class="sidebar-link">Звичайний користувач</a></li><li class="sidebar-sub-header"><a href="/database-coursework/use%20cases/#менеджер" class="sidebar-link">Менеджер</a></li><li class="sidebar-sub-header"><a href="/database-coursework/use%20cases/#адміністратор" class="sidebar-link">Адміністратор</a></li><li class="sidebar-sub-header"><a href="/database-coursework/use%20cases/#сценаріі-використання" class="sidebar-link">Сценарії використання</a></li></ul></li><li><a href="/database-coursework/design/" class="sidebar-link">Проектування інформаційного забезпечення</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/database-coursework/design/#модель-бізнес-об-єктів" class="sidebar-link">Модель бізнес об'єктів</a></li><li class="sidebar-sub-header"><a href="/database-coursework/design/#er-модель" class="sidebar-link">ER-модель</a></li><li class="sidebar-sub-header"><a href="/database-coursework/design/#реляціина-схема" class="sidebar-link">Реляційна схема</a></li></ul></li><li><a href="/database-coursework/software/" aria-current="page" class="active sidebar-link">Реалізація інформаційного та програмного забезпечення</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/database-coursework/software/#sql-скрипт-для-створення-та-початкового-наповнення-бази-даних" class="sidebar-link">SQL-скрипт для створення та початкового наповнення бази даних</a></li><li class="sidebar-sub-header"><a href="/database-coursework/software/#restful-сервіс-для-управління-даними" class="sidebar-link">RESTful сервіс для управління даними</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/database-coursework/software/#схема-бази-даних" class="sidebar-link">Схема бази даних</a></li><li class="sidebar-sub-header"><a href="/database-coursework/software/#головнии-фаил-програми" class="sidebar-link">Головний файл програми</a></li><li class="sidebar-sub-header"><a href="/database-coursework/software/#головнии-модуль-програми" class="sidebar-link">Головний модуль програми</a></li><li class="sidebar-sub-header"><a href="/database-coursework/software/#валідатор-isunique" class="sidebar-link">Валідатор IsUnique</a></li><li class="sidebar-sub-header"><a href="/database-coursework/software/#модуль-для-контролю-запитів-до-користувачів" class="sidebar-link">Модуль для контролю запитів до користувачів</a></li><li class="sidebar-sub-header"><a href="/database-coursework/software/#dto-для-створення-користувача" class="sidebar-link">DTO для створення користувача</a></li><li class="sidebar-sub-header"><a href="/database-coursework/software/#dto-для-оновлення-даних-користувача" class="sidebar-link">DTO для оновлення даних користувача</a></li><li class="sidebar-sub-header"><a href="/database-coursework/software/#контроллер-запитів-до-користувачів" class="sidebar-link">Контроллер запитів до користувачів</a></li><li class="sidebar-sub-header"><a href="/database-coursework/software/#сервіс-для-обробки-запитів-до-користувачів" class="sidebar-link">Сервіс для обробки запитів до користувачів</a></li><li class="sidebar-sub-header"><a href="/database-coursework/software/#модуль-для-контролю-запитів-до-проєктів" class="sidebar-link">Модуль для контролю запитів до проєктів</a></li><li class="sidebar-sub-header"><a href="/database-coursework/software/#dto-для-створення-проєкту" class="sidebar-link">DTO для створення проєкту</a></li><li class="sidebar-sub-header"><a href="/database-coursework/software/#dto-для-оновлення-даних-проєкту" class="sidebar-link">DTO для оновлення даних проєкту</a></li><li class="sidebar-sub-header"><a href="/database-coursework/software/#контроллер-запитів-до-проєктів" class="sidebar-link">Контроллер запитів до проєктів</a></li><li class="sidebar-sub-header"><a href="/database-coursework/software/#сервіс-для-обробки-запитів-до-проєктів" class="sidebar-link">Сервіс для обробки запитів до проєктів</a></li></ul></li></ul></li><li><a href="/database-coursework/test/" class="sidebar-link">Тестування працездатності системи</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/database-coursework/test/#запуск-системи" class="sidebar-link">Запуск системи</a></li><li class="sidebar-sub-header"><a href="/database-coursework/test/#початкове-наповнення-бази-даних" class="sidebar-link">Початкове наповнення бази даних</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/database-coursework/test/#користувач" class="sidebar-link">Користувач</a></li><li class="sidebar-sub-header"><a href="/database-coursework/test/#проєкт" class="sidebar-link">Проєкт</a></li></ul></li><li class="sidebar-sub-header"><a href="/database-coursework/test/#тестування-запитів" class="sidebar-link">Тестування запитів</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/database-coursework/test/#користувач-2" class="sidebar-link">Користувач:</a></li><li class="sidebar-sub-header"><a href="/database-coursework/test/#get-all" class="sidebar-link">Get (all)</a></li><li class="sidebar-sub-header"><a href="/database-coursework/test/#get-one" class="sidebar-link">Get (one)</a></li><li class="sidebar-sub-header"><a href="/database-coursework/test/#post" class="sidebar-link">Post</a></li><li class="sidebar-sub-header"><a href="/database-coursework/test/#patch" class="sidebar-link">Patch</a></li><li class="sidebar-sub-header"><a href="/database-coursework/test/#delete" class="sidebar-link">Delete</a></li><li class="sidebar-sub-header"><a href="/database-coursework/test/#проєкт-2" class="sidebar-link">Проєкт:</a></li><li class="sidebar-sub-header"><a href="/database-coursework/test/#get-all-2" class="sidebar-link">Get (all)</a></li><li class="sidebar-sub-header"><a href="/database-coursework/test/#get-one-2" class="sidebar-link">Get (one)</a></li><li class="sidebar-sub-header"><a href="/database-coursework/test/#post-2" class="sidebar-link">Post</a></li><li class="sidebar-sub-header"><a href="/database-coursework/test/#patch-2" class="sidebar-link">Patch</a></li><li class="sidebar-sub-header"><a href="/database-coursework/test/#delete-2" class="sidebar-link">Delete</a></li></ul></li><li class="sidebar-sub-header"><a href="/database-coursework/test/#обробка-помилок" class="sidebar-link">Обробка помилок</a></li><li class="sidebar-sub-header"><a href="/database-coursework/test/#bad-request" class="sidebar-link">Bad request</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/database-coursework/test/#користувач-3" class="sidebar-link">Користувач:</a></li><li class="sidebar-sub-header"><a href="/database-coursework/test/#проєкт-3" class="sidebar-link">Проєкт:</a></li></ul></li><li class="sidebar-sub-header"><a href="/database-coursework/test/#not-found" class="sidebar-link">Not found</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/database-coursework/test/#користувач-4" class="sidebar-link">Користувач:</a></li><li class="sidebar-sub-header"><a href="/database-coursework/test/#проєкт-4" class="sidebar-link">Проєкт:</a></li></ul></li></ul></li><li><a href="/database-coursework/conclusion/" class="sidebar-link">Висновки</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="реалізація-інформаціиного-та-програмного-забезпечення"><a href="#реалізація-інформаціиного-та-програмного-забезпечення" class="header-anchor">#</a> Реалізація інформаційного та програмного забезпечення</h1> <p>В рамках проекту розробляється:</p> <h2 id="sql-скрипт-для-створення-та-початкового-наповнення-бази-даних"><a href="#sql-скрипт-для-створення-та-початкового-наповнення-бази-даних" class="header-anchor">#</a> SQL-скрипт для створення та початкового наповнення бази даних</h2> <p><em>structure.sql</em></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- CreateEnum</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TYPE</span> <span class="token string">&quot;user_system_role&quot;</span> <span class="token keyword">AS</span> <span class="token keyword">ENUM</span> <span class="token punctuation">(</span><span class="token string">'user'</span><span class="token punctuation">,</span> <span class="token string">'admin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- CreateEnum</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TYPE</span> <span class="token string">&quot;project_status&quot;</span> <span class="token keyword">AS</span> <span class="token keyword">ENUM</span> <span class="token punctuation">(</span><span class="token string">'active'</span><span class="token punctuation">,</span> <span class="token string">'inactive'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- CreateEnum</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TYPE</span> <span class="token string">&quot;participant_role&quot;</span> <span class="token keyword">AS</span> <span class="token keyword">ENUM</span> <span class="token punctuation">(</span><span class="token string">'author'</span><span class="token punctuation">,</span> <span class="token string">'assignee'</span><span class="token punctuation">,</span> <span class="token string">'reviewer'</span><span class="token punctuation">,</span> <span class="token string">'participant'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- CreateTable</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token string">&quot;users&quot;</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;id&quot;</span> <span class="token keyword">SERIAL</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    <span class="token string">&quot;login&quot;</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    <span class="token string">&quot;password&quot;</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    <span class="token string">&quot;email&quot;</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string">&quot;phone&quot;</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string">&quot;avatar&quot;</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string">&quot;system_role&quot;</span> <span class="token string">&quot;user_system_role&quot;</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    <span class="token string">&quot;created_at&quot;</span> <span class="token keyword">TIMESTAMP</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CURRENT_TIMESTAMP</span><span class="token punctuation">,</span>
    <span class="token string">&quot;updated_at&quot;</span> <span class="token keyword">TIMESTAMP</span><span class="token punctuation">,</span>

    <span class="token keyword">CONSTRAINT</span> <span class="token string">&quot;users_pkey&quot;</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- CreateTable</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token string">&quot;messages&quot;</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;id&quot;</span> <span class="token keyword">SERIAL</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    <span class="token string">&quot;content&quot;</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">240</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    <span class="token string">&quot;created_at&quot;</span> <span class="token keyword">TIMESTAMP</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CURRENT_TIMESTAMP</span><span class="token punctuation">,</span>
    <span class="token string">&quot;sheduled_at&quot;</span> <span class="token keyword">TIMESTAMP</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>

    <span class="token keyword">CONSTRAINT</span> <span class="token string">&quot;messages_pkey&quot;</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- CreateTable</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token string">&quot;notifications&quot;</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;user_id&quot;</span> <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    <span class="token string">&quot;message_id&quot;</span> <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- CreateTable</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token string">&quot;grants&quot;</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;role_id&quot;</span> <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    <span class="token string">&quot;permission_id&quot;</span> <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    <span class="token string">&quot;created_at&quot;</span> <span class="token keyword">TIMESTAMP</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CURRENT_TIMESTAMP</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- CreateTable</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token string">&quot;members&quot;</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;id&quot;</span> <span class="token keyword">SERIAL</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    <span class="token string">&quot;user_id&quot;</span> <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    <span class="token string">&quot;project_id&quot;</span> <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    <span class="token string">&quot;role_id&quot;</span> <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    <span class="token string">&quot;created_at&quot;</span> <span class="token keyword">TIMESTAMP</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CURRENT_TIMESTAMP</span><span class="token punctuation">,</span>
    <span class="token string">&quot;updated_at&quot;</span> <span class="token keyword">TIMESTAMP</span><span class="token punctuation">,</span>

    <span class="token keyword">CONSTRAINT</span> <span class="token string">&quot;members_pkey&quot;</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- CreateTable</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token string">&quot;tasks&quot;</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;id&quot;</span> <span class="token keyword">SERIAL</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    <span class="token string">&quot;title&quot;</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    <span class="token string">&quot;status&quot;</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    <span class="token string">&quot;project_id&quot;</span> <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    <span class="token string">&quot;description&quot;</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string">&quot;deadline&quot;</span> <span class="token keyword">TIMESTAMP</span><span class="token punctuation">,</span>
    <span class="token string">&quot;created_at&quot;</span> <span class="token keyword">TIMESTAMP</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CURRENT_TIMESTAMP</span><span class="token punctuation">,</span>
    <span class="token string">&quot;updated_at&quot;</span> <span class="token keyword">TIMESTAMP</span><span class="token punctuation">,</span>

    <span class="token keyword">CONSTRAINT</span> <span class="token string">&quot;tasks_pkey&quot;</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token string">&quot;participants&quot;</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;id&quot;</span> <span class="token keyword">SERIAL</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    <span class="token string">&quot;member_id&quot;</span> <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    <span class="token string">&quot;task_id&quot;</span> <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    <span class="token string">&quot;role&quot;</span> <span class="token string">&quot;participant_role&quot;</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    <span class="token string">&quot;created_at&quot;</span> <span class="token keyword">TIMESTAMP</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CURRENT_TIMESTAMP</span><span class="token punctuation">,</span>

    <span class="token keyword">CONSTRAINT</span> <span class="token string">&quot;participants_pkey&quot;</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token string">&quot;projects&quot;</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;id&quot;</span> <span class="token keyword">SERIAL</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    <span class="token string">&quot;title&quot;</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    <span class="token string">&quot;status&quot;</span> <span class="token string">&quot;project_status&quot;</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token string">'inactive'</span><span class="token punctuation">,</span>
    <span class="token string">&quot;start_date&quot;</span> <span class="token keyword">TIMESTAMP</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    <span class="token string">&quot;end_date&quot;</span> <span class="token keyword">TIMESTAMP</span><span class="token punctuation">,</span>
    <span class="token string">&quot;created_at&quot;</span> <span class="token keyword">TIMESTAMP</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CURRENT_TIMESTAMP</span><span class="token punctuation">,</span>
    <span class="token string">&quot;updated_at&quot;</span> <span class="token keyword">TIMESTAMP</span><span class="token punctuation">,</span>
    <span class="token string">&quot;logo&quot;</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string">&quot;description&quot;</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">4000</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

    <span class="token keyword">CONSTRAINT</span> <span class="token string">&quot;projects_pkey&quot;</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- CreateTable</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token string">&quot;roles&quot;</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;id&quot;</span> <span class="token keyword">SERIAL</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    <span class="token string">&quot;name&quot;</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">45</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>

    <span class="token keyword">CONSTRAINT</span> <span class="token string">&quot;roles_pkey&quot;</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- CreateTable</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token string">&quot;permissions&quot;</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;id&quot;</span> <span class="token keyword">SERIAL</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    <span class="token string">&quot;rule&quot;</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">45</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    <span class="token string">&quot;created_at&quot;</span> <span class="token keyword">TIMESTAMP</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CURRENT_TIMESTAMP</span><span class="token punctuation">,</span>

    <span class="token keyword">CONSTRAINT</span> <span class="token string">&quot;permissions_pkey&quot;</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- CreateTable</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token string">&quot;labels&quot;</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;id&quot;</span> <span class="token keyword">SERIAL</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    <span class="token string">&quot;name&quot;</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    <span class="token string">&quot;color&quot;</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>

    <span class="token keyword">CONSTRAINT</span> <span class="token string">&quot;labels_pkey&quot;</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- CreateTable</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token string">&quot;tags&quot;</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;label_id&quot;</span> <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    <span class="token string">&quot;task_id&quot;</span> <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- CreateTable</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token string">&quot;attachments&quot;</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;id&quot;</span> <span class="token keyword">SERIAL</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    <span class="token string">&quot;url&quot;</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    <span class="token string">&quot;format&quot;</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    <span class="token string">&quot;task_id&quot;</span> <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    <span class="token string">&quot;created_at&quot;</span> <span class="token keyword">TIMESTAMP</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CURRENT_TIMESTAMP</span><span class="token punctuation">,</span>

    <span class="token keyword">CONSTRAINT</span> <span class="token string">&quot;attachments_pkey&quot;</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- CreateTable</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token string">&quot;reviews&quot;</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;id&quot;</span> <span class="token keyword">SERIAL</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    <span class="token string">&quot;task_id&quot;</span> <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    <span class="token string">&quot;participant_id&quot;</span> <span class="token keyword">INTEGER</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    <span class="token string">&quot;replied_to&quot;</span> <span class="token keyword">INTEGER</span><span class="token punctuation">,</span>
    <span class="token string">&quot;created_at&quot;</span> <span class="token keyword">TIMESTAMP</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CURRENT_TIMESTAMP</span><span class="token punctuation">,</span>
    <span class="token string">&quot;updated_at&quot;</span> <span class="token keyword">TIMESTAMP</span><span class="token punctuation">,</span>
    <span class="token string">&quot;content&quot;</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>

    <span class="token keyword">CONSTRAINT</span> <span class="token string">&quot;reviews_pkey&quot;</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- CreateIndex</span>
<span class="token keyword">CREATE</span> <span class="token keyword">UNIQUE</span> <span class="token keyword">INDEX</span> <span class="token string">&quot;users_login_key&quot;</span> <span class="token keyword">ON</span> <span class="token string">&quot;users&quot;</span><span class="token punctuation">(</span><span class="token string">&quot;login&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- CreateIndex</span>
<span class="token keyword">CREATE</span> <span class="token keyword">UNIQUE</span> <span class="token keyword">INDEX</span> <span class="token string">&quot;users_email_key&quot;</span> <span class="token keyword">ON</span> <span class="token string">&quot;users&quot;</span><span class="token punctuation">(</span><span class="token string">&quot;email&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- CreateIndex</span>
<span class="token keyword">CREATE</span> <span class="token keyword">UNIQUE</span> <span class="token keyword">INDEX</span> <span class="token string">&quot;users_phone_key&quot;</span> <span class="token keyword">ON</span> <span class="token string">&quot;users&quot;</span><span class="token punctuation">(</span><span class="token string">&quot;phone&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- CreateIndex</span>
<span class="token keyword">CREATE</span> <span class="token keyword">UNIQUE</span> <span class="token keyword">INDEX</span> <span class="token string">&quot;notifications_user_id_message_id_key&quot;</span> <span class="token keyword">ON</span> <span class="token string">&quot;notifications&quot;</span><span class="token punctuation">(</span><span class="token string">&quot;user_id&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;message_id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- CreateIndex</span>
<span class="token keyword">CREATE</span> <span class="token keyword">UNIQUE</span> <span class="token keyword">INDEX</span> <span class="token string">&quot;projects_title_key&quot;</span> <span class="token keyword">ON</span> <span class="token string">&quot;projects&quot;</span><span class="token punctuation">(</span><span class="token string">&quot;title&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- CreateIndex</span>
<span class="token keyword">CREATE</span> <span class="token keyword">UNIQUE</span> <span class="token keyword">INDEX</span> <span class="token string">&quot;roles_name_key&quot;</span> <span class="token keyword">ON</span> <span class="token string">&quot;roles&quot;</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- CreateIndex</span>
<span class="token keyword">CREATE</span> <span class="token keyword">UNIQUE</span> <span class="token keyword">INDEX</span> <span class="token string">&quot;permissions_rule_key&quot;</span> <span class="token keyword">ON</span> <span class="token string">&quot;permissions&quot;</span><span class="token punctuation">(</span><span class="token string">&quot;rule&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- CreateIndex</span>
<span class="token keyword">CREATE</span> <span class="token keyword">UNIQUE</span> <span class="token keyword">INDEX</span> <span class="token string">&quot;grants_role_id_permission_id_key&quot;</span> <span class="token keyword">ON</span> <span class="token string">&quot;grants&quot;</span><span class="token punctuation">(</span><span class="token string">&quot;role_id&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;permission_id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- CreateIndex</span>
<span class="token keyword">CREATE</span> <span class="token keyword">UNIQUE</span> <span class="token keyword">INDEX</span> <span class="token string">&quot;members_user_id_project_id_key&quot;</span> <span class="token keyword">ON</span> <span class="token string">&quot;members&quot;</span><span class="token punctuation">(</span><span class="token string">&quot;user_id&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;project_id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- CreateIndex</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> <span class="token string">&quot;tasks_project_id_idx&quot;</span> <span class="token keyword">ON</span> <span class="token string">&quot;tasks&quot;</span><span class="token punctuation">(</span><span class="token string">&quot;project_id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- CreateIndex</span>
<span class="token keyword">CREATE</span> <span class="token keyword">UNIQUE</span> <span class="token keyword">INDEX</span> <span class="token string">&quot;participants_member_id_task_id_key&quot;</span> <span class="token keyword">ON</span> <span class="token string">&quot;participants&quot;</span><span class="token punctuation">(</span><span class="token string">&quot;member_id&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;task_id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- CreateIndex</span>
<span class="token keyword">CREATE</span> <span class="token keyword">UNIQUE</span> <span class="token keyword">INDEX</span> <span class="token string">&quot;labels_name_key&quot;</span> <span class="token keyword">ON</span> <span class="token string">&quot;labels&quot;</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- CreateIndex</span>
<span class="token keyword">CREATE</span> <span class="token keyword">UNIQUE</span> <span class="token keyword">INDEX</span> <span class="token string">&quot;tags_label_id_task_id_key&quot;</span> <span class="token keyword">ON</span> <span class="token string">&quot;tags&quot;</span><span class="token punctuation">(</span><span class="token string">&quot;label_id&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;task_id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- CreateIndex</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> <span class="token string">&quot;attachments_task_id_idx&quot;</span> <span class="token keyword">ON</span> <span class="token string">&quot;attachments&quot;</span><span class="token punctuation">(</span><span class="token string">&quot;task_id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- CreateIndex</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> <span class="token string">&quot;reviews_task_id_idx&quot;</span> <span class="token keyword">ON</span> <span class="token string">&quot;reviews&quot;</span><span class="token punctuation">(</span><span class="token string">&quot;task_id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- AddForeignKey</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> <span class="token string">&quot;notifications&quot;</span> <span class="token keyword">ADD</span> <span class="token keyword">CONSTRAINT</span> <span class="token string">&quot;notifications_user_id_fkey&quot;</span> <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token string">&quot;user_id&quot;</span><span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> <span class="token string">&quot;users&quot;</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">DELETE</span> <span class="token keyword">CASCADE</span> <span class="token keyword">ON</span> <span class="token keyword">UPDATE</span> <span class="token keyword">CASCADE</span><span class="token punctuation">;</span>

<span class="token comment">-- AddForeignKey</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> <span class="token string">&quot;notifications&quot;</span> <span class="token keyword">ADD</span> <span class="token keyword">CONSTRAINT</span> <span class="token string">&quot;notifications_message_id_fkey&quot;</span> <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token string">&quot;message_id&quot;</span><span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> <span class="token string">&quot;messages&quot;</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">DELETE</span> <span class="token keyword">CASCADE</span> <span class="token keyword">ON</span> <span class="token keyword">UPDATE</span> <span class="token keyword">CASCADE</span><span class="token punctuation">;</span>

<span class="token comment">-- AddForeignKey</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> <span class="token string">&quot;grants&quot;</span> <span class="token keyword">ADD</span> <span class="token keyword">CONSTRAINT</span> <span class="token string">&quot;grants_role_id_fkey&quot;</span> <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token string">&quot;role_id&quot;</span><span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> <span class="token string">&quot;roles&quot;</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">DELETE</span> <span class="token keyword">CASCADE</span> <span class="token keyword">ON</span> <span class="token keyword">UPDATE</span> <span class="token keyword">CASCADE</span><span class="token punctuation">;</span>

<span class="token comment">-- AddForeignKey</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> <span class="token string">&quot;grants&quot;</span> <span class="token keyword">ADD</span> <span class="token keyword">CONSTRAINT</span> <span class="token string">&quot;grants_permission_id_fkey&quot;</span> <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token string">&quot;permission_id&quot;</span><span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> <span class="token string">&quot;permissions&quot;</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">DELETE</span> <span class="token keyword">CASCADE</span> <span class="token keyword">ON</span> <span class="token keyword">UPDATE</span> <span class="token keyword">CASCADE</span><span class="token punctuation">;</span>

<span class="token comment">-- AddForeignKey</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> <span class="token string">&quot;members&quot;</span> <span class="token keyword">ADD</span> <span class="token keyword">CONSTRAINT</span> <span class="token string">&quot;members_user_id_fkey&quot;</span> <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token string">&quot;user_id&quot;</span><span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> <span class="token string">&quot;users&quot;</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">DELETE</span> <span class="token keyword">CASCADE</span> <span class="token keyword">ON</span> <span class="token keyword">UPDATE</span> <span class="token keyword">CASCADE</span><span class="token punctuation">;</span>

<span class="token comment">-- AddForeignKey</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> <span class="token string">&quot;members&quot;</span> <span class="token keyword">ADD</span> <span class="token keyword">CONSTRAINT</span> <span class="token string">&quot;members_project_id_fkey&quot;</span> <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token string">&quot;project_id&quot;</span><span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> <span class="token string">&quot;projects&quot;</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">DELETE</span> <span class="token keyword">CASCADE</span> <span class="token keyword">ON</span> <span class="token keyword">UPDATE</span> <span class="token keyword">CASCADE</span><span class="token punctuation">;</span>

<span class="token comment">-- AddForeignKey</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> <span class="token string">&quot;members&quot;</span> <span class="token keyword">ADD</span> <span class="token keyword">CONSTRAINT</span> <span class="token string">&quot;members_role_id_fkey&quot;</span> <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token string">&quot;role_id&quot;</span><span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> <span class="token string">&quot;roles&quot;</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">DELETE</span> <span class="token keyword">RESTRICT</span> <span class="token keyword">ON</span> <span class="token keyword">UPDATE</span> <span class="token keyword">CASCADE</span><span class="token punctuation">;</span>

<span class="token comment">-- AddForeignKey</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> <span class="token string">&quot;tasks&quot;</span> <span class="token keyword">ADD</span> <span class="token keyword">CONSTRAINT</span> <span class="token string">&quot;tasks_project_id_fkey&quot;</span> <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token string">&quot;project_id&quot;</span><span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> <span class="token string">&quot;projects&quot;</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">DELETE</span> <span class="token keyword">CASCADE</span> <span class="token keyword">ON</span> <span class="token keyword">UPDATE</span> <span class="token keyword">CASCADE</span><span class="token punctuation">;</span>

<span class="token comment">-- AddForeignKey</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> <span class="token string">&quot;participants&quot;</span> <span class="token keyword">ADD</span> <span class="token keyword">CONSTRAINT</span> <span class="token string">&quot;participants_member_id_fkey&quot;</span> <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token string">&quot;member_id&quot;</span><span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> <span class="token string">&quot;members&quot;</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">DELETE</span> <span class="token keyword">CASCADE</span> <span class="token keyword">ON</span> <span class="token keyword">UPDATE</span> <span class="token keyword">CASCADE</span><span class="token punctuation">;</span>

<span class="token comment">-- AddForeignKey</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> <span class="token string">&quot;participants&quot;</span> <span class="token keyword">ADD</span> <span class="token keyword">CONSTRAINT</span> <span class="token string">&quot;participants_task_id_fkey&quot;</span> <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token string">&quot;task_id&quot;</span><span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> <span class="token string">&quot;tasks&quot;</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">DELETE</span> <span class="token keyword">CASCADE</span> <span class="token keyword">ON</span> <span class="token keyword">UPDATE</span> <span class="token keyword">CASCADE</span><span class="token punctuation">;</span>

<span class="token comment">-- AddForeignKey</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> <span class="token string">&quot;tags&quot;</span> <span class="token keyword">ADD</span> <span class="token keyword">CONSTRAINT</span> <span class="token string">&quot;tags_label_id_fkey&quot;</span> <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token string">&quot;label_id&quot;</span><span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> <span class="token string">&quot;labels&quot;</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">DELETE</span> <span class="token keyword">CASCADE</span> <span class="token keyword">ON</span> <span class="token keyword">UPDATE</span> <span class="token keyword">CASCADE</span><span class="token punctuation">;</span>

<span class="token comment">-- AddForeignKey</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> <span class="token string">&quot;tags&quot;</span> <span class="token keyword">ADD</span> <span class="token keyword">CONSTRAINT</span> <span class="token string">&quot;tags_task_id_fkey&quot;</span> <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token string">&quot;task_id&quot;</span><span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> <span class="token string">&quot;tasks&quot;</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">DELETE</span> <span class="token keyword">CASCADE</span> <span class="token keyword">ON</span> <span class="token keyword">UPDATE</span> <span class="token keyword">CASCADE</span><span class="token punctuation">;</span>

<span class="token comment">-- AddForeignKey</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> <span class="token string">&quot;attachments&quot;</span> <span class="token keyword">ADD</span> <span class="token keyword">CONSTRAINT</span> <span class="token string">&quot;attachments_task_id_fkey&quot;</span> <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token string">&quot;task_id&quot;</span><span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> <span class="token string">&quot;tasks&quot;</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">DELETE</span> <span class="token keyword">CASCADE</span> <span class="token keyword">ON</span> <span class="token keyword">UPDATE</span> <span class="token keyword">CASCADE</span><span class="token punctuation">;</span>

<span class="token comment">-- AddForeignKey</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> <span class="token string">&quot;reviews&quot;</span> <span class="token keyword">ADD</span> <span class="token keyword">CONSTRAINT</span> <span class="token string">&quot;reviews_task_id_fkey&quot;</span> <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token string">&quot;task_id&quot;</span><span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> <span class="token string">&quot;tasks&quot;</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">DELETE</span> <span class="token keyword">CASCADE</span> <span class="token keyword">ON</span> <span class="token keyword">UPDATE</span> <span class="token keyword">CASCADE</span><span class="token punctuation">;</span>

<span class="token comment">-- AddForeignKey</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> <span class="token string">&quot;reviews&quot;</span> <span class="token keyword">ADD</span> <span class="token keyword">CONSTRAINT</span> <span class="token string">&quot;reviews_participant_id_fkey&quot;</span> <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token string">&quot;participant_id&quot;</span><span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> <span class="token string">&quot;participants&quot;</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">DELETE</span> <span class="token keyword">CASCADE</span> <span class="token keyword">ON</span> <span class="token keyword">UPDATE</span> <span class="token keyword">CASCADE</span><span class="token punctuation">;</span>

<span class="token comment">-- AddForeignKey</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> <span class="token string">&quot;reviews&quot;</span> <span class="token keyword">ADD</span> <span class="token keyword">CONSTRAINT</span> <span class="token string">&quot;reviews_replied_to_fkey&quot;</span> <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token string">&quot;replied_to&quot;</span><span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> <span class="token string">&quot;reviews&quot;</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">DELETE</span> <span class="token keyword">CASCADE</span> <span class="token keyword">ON</span> <span class="token keyword">UPDATE</span> <span class="token keyword">CASCADE</span><span class="token punctuation">;</span>
</code></pre></div><p><em>seed.sql</em></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">BEGIN</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token string">&quot;users&quot;</span> <span class="token punctuation">(</span><span class="token string">&quot;login&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;password&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;phone&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;email&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;avatar&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;system_role&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;created_at&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;updated_at&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">VALUES</span>
  <span class="token punctuation">(</span><span class="token string">'Rubie_Zulauf'</span><span class="token punctuation">,</span> <span class="token string">'test1234'</span><span class="token punctuation">,</span> <span class="token string">'9715010660'</span><span class="token punctuation">,</span> <span class="token string">'Rubie_Zulauf22@yahoo.com'</span><span class="token punctuation">,</span> <span class="token string">'https://cloudflare-ipfs.com/ipfs/Qmd3W5DuhgHirLHGVixi6V76LhCkZUz6pnFt5AJBiyvHye/avatar/206.jpg'</span><span class="token punctuation">,</span> <span class="token string">'user'</span><span class="token punctuation">,</span> <span class="token string">'2023-09-12T22:01:21.430Z'</span><span class="token punctuation">,</span> <span class="token string">'2023-10-17T20:26:28.535Z'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token string">'Lucile36'</span><span class="token punctuation">,</span> <span class="token string">'test1234'</span><span class="token punctuation">,</span> <span class="token string">'4419198163'</span><span class="token punctuation">,</span> <span class="token string">'Lucile.Wolff63@hotmail.com'</span><span class="token punctuation">,</span> <span class="token string">'https://cloudflare-ipfs.com/ipfs/Qmd3W5DuhgHirLHGVixi6V76LhCkZUz6pnFt5AJBiyvHye/avatar/590.jpg'</span><span class="token punctuation">,</span> <span class="token string">'user'</span><span class="token punctuation">,</span> <span class="token string">'2023-04-16T07:42:49.654Z'</span><span class="token punctuation">,</span> <span class="token string">'2023-08-12T03:27:00.716Z'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token string">'Benjamin10'</span><span class="token punctuation">,</span> <span class="token string">'test1234'</span><span class="token punctuation">,</span> <span class="token string">'8663409542'</span><span class="token punctuation">,</span> <span class="token string">'Benjamin.Stoltenberg34@yahoo.com'</span><span class="token punctuation">,</span> <span class="token string">'https://cloudflare-ipfs.com/ipfs/Qmd3W5DuhgHirLHGVixi6V76LhCkZUz6pnFt5AJBiyvHye/avatar/630.jpg'</span><span class="token punctuation">,</span> <span class="token string">'user'</span><span class="token punctuation">,</span> <span class="token string">'2023-09-12T09:35:37.492Z'</span><span class="token punctuation">,</span> <span class="token string">'2023-11-10T03:41:27.025Z'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token string">'Mckenna.Lubowitz'</span><span class="token punctuation">,</span> <span class="token string">'test1234'</span><span class="token punctuation">,</span> <span class="token string">'6509283826'</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'https://cloudflare-ipfs.com/ipfs/Qmd3W5DuhgHirLHGVixi6V76LhCkZUz6pnFt5AJBiyvHye/avatar/874.jpg'</span><span class="token punctuation">,</span> <span class="token string">'user'</span><span class="token punctuation">,</span> <span class="token string">'2023-07-08T08:18:11.106Z'</span><span class="token punctuation">,</span> <span class="token string">'2023-10-24T18:08:20.400Z'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token string">'Jessica_Schmeler80'</span><span class="token punctuation">,</span> <span class="token string">'test1234'</span><span class="token punctuation">,</span> <span class="token string">'9245290457'</span><span class="token punctuation">,</span> <span class="token string">'Jessica_Schmeler@gmail.com'</span><span class="token punctuation">,</span> <span class="token string">'https://cloudflare-ipfs.com/ipfs/Qmd3W5DuhgHirLHGVixi6V76LhCkZUz6pnFt5AJBiyvHye/avatar/7.jpg'</span><span class="token punctuation">,</span> <span class="token string">'user'</span><span class="token punctuation">,</span> <span class="token string">'2023-07-12T08:25:43.545Z'</span><span class="token punctuation">,</span> <span class="token string">'2023-10-30T14:49:46.755Z'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token string">&quot;messages&quot;</span> <span class="token punctuation">(</span><span class="token string">&quot;content&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;created_at&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;sheduled_at&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">VALUES</span>
  <span class="token punctuation">(</span><span class="token string">'Vado taceo aeger virtus verbera itaque. Aggredior ocer tremo somniculosus cras tantum. Cito vindico vilitas peior denique aspernatur.'</span><span class="token punctuation">,</span> <span class="token string">'2023-04-28T08:13:42.378Z'</span><span class="token punctuation">,</span> <span class="token string">'2023-10-19T05:27:49.093Z'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token string">'Somnus sufficio cursim blandior. Bestia textus quis cohors comburo pecco concedo. Distinctio conservo venustas angustus ara celebrer.'</span><span class="token punctuation">,</span> <span class="token string">'2023-05-15T13:55:43.431Z'</span><span class="token punctuation">,</span> <span class="token string">'2023-09-19T00:57:48.772Z'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token string">'Vestrum solium defetiscor civis quidem tamen. Vergo tricesimus celebrer bis eveniet. Charisma viriliter charisma cursus sapiente.'</span><span class="token punctuation">,</span> <span class="token string">'2022-12-03T13:17:00.168Z'</span><span class="token punctuation">,</span> <span class="token string">'2022-12-07T10:55:32.784Z'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token string">'Tenetur admoveo antiquus coerceo vitae tumultus. Auditor tredecim cibus. Conatus desolo attonbitus deleniti comptus tempore sustineo ater cura administratio.'</span><span class="token punctuation">,</span> <span class="token string">'2023-07-27T02:48:21.767Z'</span><span class="token punctuation">,</span> <span class="token string">'2023-10-16T23:37:07.711Z'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token string">'Mollitia voluptatum torrens tabesco alioqui taedium sonitus. Clementia collum crastinus vulticulus tubineus ratione quam argentum. Vere terminatio blandior teneo adicio utroque demitto uter urbs.'</span><span class="token punctuation">,</span> <span class="token string">'2022-11-30T18:54:26.252Z'</span><span class="token punctuation">,</span> <span class="token string">'2023-03-21T00:10:00.505Z'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token string">&quot;notifications&quot;</span> <span class="token punctuation">(</span><span class="token string">&quot;user_id&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;message_id&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">VALUES</span>
  <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token string">&quot;permissions&quot;</span> <span class="token punctuation">(</span><span class="token string">&quot;rule&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;created_at&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">VALUES</span>
  <span class="token punctuation">(</span><span class="token string">'CREATE PROJECT'</span><span class="token punctuation">,</span> <span class="token string">'2022-01-01T00:00:00.000Z'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token string">'READ PROJECT'</span><span class="token punctuation">,</span> <span class="token string">'2022-01-01T00:00:00.000Z'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token string">'UPDATE PROJECT'</span><span class="token punctuation">,</span> <span class="token string">'2022-01-01T00:00:00.000Z'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token string">'DELETE PROJECT'</span><span class="token punctuation">,</span> <span class="token string">'2022-01-01T00:00:00.000Z'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token string">'CREATE TASK'</span><span class="token punctuation">,</span> <span class="token string">'2022-01-01T00:00:00.000Z'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token string">'READ TASK'</span><span class="token punctuation">,</span> <span class="token string">'2022-01-01T00:00:00.000Z'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token string">'UPDATE TASK'</span><span class="token punctuation">,</span> <span class="token string">'2022-01-01T00:00:00.000Z'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token string">'DELETE TASK'</span><span class="token punctuation">,</span> <span class="token string">'2022-01-01T00:00:00.000Z'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token string">'CREATE COMMENT'</span><span class="token punctuation">,</span> <span class="token string">'2022-01-01T00:00:00.000Z'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token string">'READ COMMENT'</span><span class="token punctuation">,</span> <span class="token string">'2022-01-01T00:00:00.000Z'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token string">'UPDATE COMMENT'</span><span class="token punctuation">,</span> <span class="token string">'2022-01-01T00:00:00.000Z'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token string">'DELETE COMMENT'</span><span class="token punctuation">,</span> <span class="token string">'2022-01-01T00:00:00.000Z'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token string">'CREATE MEMBER'</span><span class="token punctuation">,</span> <span class="token string">'2022-01-01T00:00:00.000Z'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token string">'UPDATE MEMBER'</span><span class="token punctuation">,</span> <span class="token string">'2022-01-01T00:00:00.000Z'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token string">'DELETE MEMBER'</span><span class="token punctuation">,</span> <span class="token string">'2022-01-01T00:00:00.000Z'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token string">'CREATE ROLE'</span><span class="token punctuation">,</span> <span class="token string">'2022-01-01T00:00:00.000Z'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token string">'READ ROLE'</span><span class="token punctuation">,</span> <span class="token string">'2022-01-01T00:00:00.000Z'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token string">'UPDATE ROLE'</span><span class="token punctuation">,</span> <span class="token string">'2022-01-01T00:00:00.000Z'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token string">'DELETE ROLE'</span><span class="token punctuation">,</span> <span class="token string">'2022-01-01T00:00:00.000Z'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token string">&quot;roles&quot;</span> <span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">VALUES</span>
  <span class="token punctuation">(</span><span class="token string">'manager'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token string">'member'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token string">&quot;grants&quot;</span> <span class="token punctuation">(</span><span class="token string">&quot;role_id&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;permission_id&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">VALUES</span>
  <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token string">&quot;projects&quot;</span> <span class="token punctuation">(</span><span class="token string">&quot;title&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;status&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;description&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;logo&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;start_date&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;end_date&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;created_at&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;updated_at&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">VALUES</span>
  <span class="token punctuation">(</span><span class="token string">'Bellum Speculum'</span><span class="token punctuation">,</span> <span class="token string">'inactive'</span><span class="token punctuation">,</span> <span class="token string">'Vir bestia arguo tendo varius. Et clementia vesco tyrannus subito cupiditas ambitus solutio voco tutis. Conservo hic damno animadverto arca.
Agnosco cibus comprehendo testimonium avaritia. Surgo harum contra. Dolorum unde adfero admiratio.'</span><span class="token punctuation">,</span> <span class="token string">'https://cloudflare-ipfs.com/ipfs/Qmd3W5DuhgHirLHGVixi6V76LhCkZUz6pnFt5AJBiyvHye/avatar/19.jpg'</span><span class="token punctuation">,</span> <span class="token string">'2023-06-29T17:33:33.005Z'</span><span class="token punctuation">,</span> <span class="token string">'2023-06-30T07:18:48.810Z'</span><span class="token punctuation">,</span> <span class="token string">'2023-02-08T10:55:30.473Z'</span><span class="token punctuation">,</span> <span class="token string">'2023-08-06T08:39:54.672Z'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token string">'Acer Angelus'</span><span class="token punctuation">,</span> <span class="token string">'inactive'</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'https://cloudflare-ipfs.com/ipfs/Qmd3W5DuhgHirLHGVixi6V76LhCkZUz6pnFt5AJBiyvHye/avatar/679.jpg'</span><span class="token punctuation">,</span> <span class="token string">'2023-09-15T22:49:18.223Z'</span><span class="token punctuation">,</span> <span class="token string">'2023-09-28T15:37:50.611Z'</span><span class="token punctuation">,</span> <span class="token string">'2023-06-30T12:38:30.294Z'</span><span class="token punctuation">,</span> <span class="token string">'2023-10-20T15:23:40.307Z'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token string">'Perferendis'</span><span class="token punctuation">,</span> <span class="token string">'active'</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'https://cloudflare-ipfs.com/ipfs/Qmd3W5DuhgHirLHGVixi6V76LhCkZUz6pnFt5AJBiyvHye/avatar/1110.jpg'</span><span class="token punctuation">,</span> <span class="token string">'2023-11-22T08:33:04.232Z'</span><span class="token punctuation">,</span> <span class="token string">'2023-11-22T11:24:20.195Z'</span><span class="token punctuation">,</span> <span class="token string">'2023-11-21T14:12:00.105Z'</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token string">'Dolorem'</span><span class="token punctuation">,</span> <span class="token string">'inactive'</span><span class="token punctuation">,</span> <span class="token string">'Vesica studio excepturi magnam consequuntur eius tantum cena arcus supellex. Vaco caveo tot versus vis. Conor cetera venia bonus ascisco pauci quam tribuo.
Architecto expedita solio caecus vivo una nam bellicus. Subito accendo arbor. Curtus cicuta quod claudeo arto averto.
Demoror esse inflammatio. Auctus supra libero synagoga crudelis arcus desolo soluta repellat. Accommodo varietas decens credo vinculum occaecati desolo desipio temptatio.
Inventore torrens virgo tum. Urbs arcesso unus averto comptus. Varius cuius acceptus.'</span><span class="token punctuation">,</span> <span class="token string">'https://cloudflare-ipfs.com/ipfs/Qmd3W5DuhgHirLHGVixi6V76LhCkZUz6pnFt5AJBiyvHye/avatar/996.jpg'</span><span class="token punctuation">,</span> <span class="token string">'2023-08-16T05:12:24.540Z'</span><span class="token punctuation">,</span> <span class="token string">'2023-11-19T05:47:10.034Z'</span><span class="token punctuation">,</span> <span class="token string">'2023-07-25T07:35:16.877Z'</span><span class="token punctuation">,</span> <span class="token string">'2023-09-05T14:19:54.585Z'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token string">'Ocer'</span><span class="token punctuation">,</span> <span class="token string">'active'</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'https://cloudflare-ipfs.com/ipfs/Qmd3W5DuhgHirLHGVixi6V76LhCkZUz6pnFt5AJBiyvHye/avatar/853.jpg'</span><span class="token punctuation">,</span> <span class="token string">'2023-06-08T23:42:49.824Z'</span><span class="token punctuation">,</span> <span class="token string">'2023-07-31T09:37:20.148Z'</span><span class="token punctuation">,</span> <span class="token string">'2023-03-29T05:01:53.436Z'</span><span class="token punctuation">,</span> <span class="token string">'2023-04-05T08:52:37.702Z'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token string">&quot;members&quot;</span> <span class="token punctuation">(</span><span class="token string">&quot;user_id&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;project_id&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;role_id&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;created_at&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;updated_at&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">VALUES</span>
  <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'2023-02-08T10:55:30.473Z'</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'2023-06-30T12:38:30.294Z'</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'2023-11-21T14:12:00.105Z'</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'2023-07-25T07:35:16.877Z'</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'2023-03-29T05:01:53.436Z'</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'2023-08-04T22:23:01.047Z'</span><span class="token punctuation">,</span> <span class="token string">'2023-10-20T20:57:54.811Z'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'2023-02-18T05:38:08.025Z'</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'2023-04-08T13:27:07.104Z'</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'2023-03-31T07:05:05.204Z'</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'2023-02-20T12:44:09.595Z'</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token string">&quot;tasks&quot;</span> <span class="token punctuation">(</span><span class="token string">&quot;title&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;status&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;project_id&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;description&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;deadline&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;created_at&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;updated_at&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">VALUES</span>
  <span class="token punctuation">(</span><span class="token string">'Pauci averto culpa amitto'</span><span class="token punctuation">,</span> <span class="token string">'In progress'</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'2023-11-12T03:47:19.412Z'</span><span class="token punctuation">,</span> <span class="token string">'2023-11-07T17:22:54.979Z'</span><span class="token punctuation">,</span> <span class="token string">'2023-11-14T10:44:27.158Z'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token string">'Assentator neque cunabula'</span><span class="token punctuation">,</span> <span class="token string">'Review'</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'2023-11-04T23:13:29.890Z'</span><span class="token punctuation">,</span> <span class="token string">'2023-08-27T10:16:46.349Z'</span><span class="token punctuation">,</span> <span class="token string">'2023-09-01T04:19:34.335Z'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token string">'Curso utilis'</span><span class="token punctuation">,</span> <span class="token string">'Todo'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'2023-10-17T21:28:02.737Z'</span><span class="token punctuation">,</span> <span class="token string">'2023-10-21T00:38:57.449Z'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token string">'Vereor inventore vorago provident'</span><span class="token punctuation">,</span> <span class="token string">'In progress'</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'2023-10-13T22:28:39.018Z'</span><span class="token punctuation">,</span> <span class="token string">'2023-08-09T19:13:15.597Z'</span><span class="token punctuation">,</span> <span class="token string">'2023-10-15T21:11:45.356Z'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token string">'Asper absque amissio'</span><span class="token punctuation">,</span> <span class="token string">'Todo'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'2023-11-12T16:25:14.596Z'</span><span class="token punctuation">,</span> <span class="token string">'2023-11-17T14:30:43.872Z'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token string">&quot;labels&quot;</span> <span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;color&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">VALUES</span>
  <span class="token punctuation">(</span><span class="token string">'soleo'</span><span class="token punctuation">,</span> <span class="token string">'#ee1eda'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token string">'strues viscus'</span><span class="token punctuation">,</span> <span class="token string">'#1f1b0e'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token string">'stips'</span><span class="token punctuation">,</span> <span class="token string">'#1043cc'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token string">'solitudo valens reprehenderit'</span><span class="token punctuation">,</span> <span class="token string">'#a0c3b1'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token string">'corona'</span><span class="token punctuation">,</span> <span class="token string">'#1cf63b'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token string">&quot;tags&quot;</span> <span class="token punctuation">(</span><span class="token string">&quot;task_id&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;label_id&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">VALUES</span>
  <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token string">&quot;attachments&quot;</span> <span class="token punctuation">(</span><span class="token string">&quot;task_id&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;url&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;format&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;created_at&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">VALUES</span>
  <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">'https://s3.amazonaws.com/bucket/c.mpeg'</span><span class="token punctuation">,</span> <span class="token string">'audio'</span><span class="token punctuation">,</span> <span class="token string">'2023-11-12T16:25:14.596Z'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">'https://s3.amazonaws.com/bucket/r.txt'</span><span class="token punctuation">,</span> <span class="token string">'text'</span><span class="token punctuation">,</span> <span class="token string">'2023-08-09T19:13:15.597Z'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">'https://s3.amazonaws.com/bucket/u.pdf'</span><span class="token punctuation">,</span> <span class="token string">'application'</span><span class="token punctuation">,</span> <span class="token string">'2023-08-09T19:13:15.597Z'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">'https://s3.amazonaws.com/bucket/K.jpeg'</span><span class="token punctuation">,</span> <span class="token string">'image'</span><span class="token punctuation">,</span> <span class="token string">'2023-11-12T16:25:14.596Z'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'https://s3.amazonaws.com/bucket/m.txt'</span><span class="token punctuation">,</span> <span class="token string">'text'</span><span class="token punctuation">,</span> <span class="token string">'2023-11-07T17:22:54.979Z'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token string">&quot;participants&quot;</span> <span class="token punctuation">(</span><span class="token string">&quot;member_id&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;task_id&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;role&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;created_at&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">VALUES</span>
  <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'author'</span><span class="token punctuation">,</span> <span class="token string">'2023-11-07T17:22:54.979Z'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'author'</span><span class="token punctuation">,</span> <span class="token string">'2023-08-27T10:16:46.349Z'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'author'</span><span class="token punctuation">,</span> <span class="token string">'2023-10-17T21:28:02.737Z'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">'author'</span><span class="token punctuation">,</span> <span class="token string">'2023-08-09T19:13:15.597Z'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">'author'</span><span class="token punctuation">,</span> <span class="token string">'2023-11-12T16:25:14.596Z'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'assignee'</span><span class="token punctuation">,</span> <span class="token string">'2023-08-28T10:57:59.560Z'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">'reviewer'</span><span class="token punctuation">,</span> <span class="token string">'2023-08-14T14:30:45.315Z'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">'reviewer'</span><span class="token punctuation">,</span> <span class="token string">'2023-11-17T00:37:28.685Z'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">'assignee'</span><span class="token punctuation">,</span> <span class="token string">'2023-11-14T14:29:01.165Z'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'reviewer'</span><span class="token punctuation">,</span> <span class="token string">'2023-11-10T19:44:23.925Z'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token string">&quot;reviews&quot;</span> <span class="token punctuation">(</span><span class="token string">&quot;participant_id&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;task_id&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;replied_to&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;content&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;created_at&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;updated_at&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">VALUES</span>
  <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'Tamdiu volup sollers contabesco tristis sapiente comburo charisma at. Coniecto volva labore qui cura. Dignissimos temeritas adeptio calamitas aiunt calcar trucido circumvenio.'</span><span class="token punctuation">,</span> <span class="token string">'2023-11-12T16:25:14.596Z'</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'Compello sub error succedo temperantia. Repudiandae esse vulgaris thymum sublime speciosus decumbo aggero cubitum. Confugo apostolus sollicito venia crux.
Varietas turbo alioqui. Tenus atqui xiphias collum strues. Cado consuasor natus.'</span><span class="token punctuation">,</span> <span class="token string">'2023-11-12T16:25:14.596Z'</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'Adsuesco adhaero delego fugiat bos pel. Spiculum censura adfectus terreo. Suadeo architecto stultus carus tabella blanditiis velit vesper territo veritatis.'</span><span class="token punctuation">,</span> <span class="token string">'2023-08-27T10:16:46.349Z'</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'Curatio cetera beatae dolorem caecus sequi vaco. Villa curo numquam. Dapifer aufero solitudo abbas condico auditor rem adstringo.
Omnis dicta aestivus eius. Tremo cur calamitas vorago casus spargo carpo aufero argumentum amplexus. Tricesimus subnecto titulus conforto cernuus decor benigne.'</span><span class="token punctuation">,</span> <span class="token string">'2023-08-27T10:16:46.349Z'</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'Enim cinis apparatus altus auctor laboriosam nobis debilito. Timidus vere calcar corroboro cupio adeptio. Vitiosus reiciendis nemo umquam autem damno.
Verecundia eaque volubilis dignissimos deleniti amor chirographum cuius dolorum. Peior sit averto sophismata ante commemoro aspicio uterque dignissimos. Supplanto tabesco coniuratio cetera conservo corrumpo cura.'</span><span class="token punctuation">,</span> <span class="token string">'2023-10-17T21:28:02.737Z'</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">COMMIT</span><span class="token punctuation">;</span>
</code></pre></div><p><em>setup.sh</em></p> <div class="language-shell extra-class"><pre class="language-shell"><code>psql <span class="token parameter variable">-f</span> install.sql <span class="token parameter variable">-U</span> postgres
psql <span class="token parameter variable">-d</span> versys <span class="token parameter variable">-f</span> ./structure.sql <span class="token parameter variable">-U</span> marcus
psql <span class="token parameter variable">-d</span> versys <span class="token parameter variable">-f</span> ./seed.sql <span class="token parameter variable">-U</span> marcus
psql <span class="token parameter variable">-d</span> versys <span class="token parameter variable">-U</span> marcus
</code></pre></div><h2 id="restful-сервіс-для-управління-даними"><a href="#restful-сервіс-для-управління-даними" class="header-anchor">#</a> RESTful сервіс для управління даними</h2> <h3 id="схема-бази-даних"><a href="#схема-бази-даних" class="header-anchor">#</a> Схема бази даних</h3> <div class="language-typescript extra-class"><pre class="language-typescript"><code>generator client <span class="token punctuation">{</span>
  provider <span class="token operator">=</span> <span class="token string">&quot;prisma-client-js&quot;</span>
<span class="token punctuation">}</span>

datasource db <span class="token punctuation">{</span>
  provider <span class="token operator">=</span> <span class="token string">&quot;postgresql&quot;</span>
  url      <span class="token operator">=</span> <span class="token function">env</span><span class="token punctuation">(</span><span class="token string">&quot;DATABASE_URL&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

model attachments <span class="token punctuation">{</span>
  id         Int      <span class="token decorator"><span class="token at operator">@</span><span class="token function">id</span></span> @<span class="token keyword">default</span><span class="token punctuation">(</span><span class="token function">autoincrement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  url        String   <span class="token decorator"><span class="token at operator">@</span><span class="token function">db</span></span><span class="token punctuation">.</span><span class="token function">VarChar</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span>
  format     String   <span class="token decorator"><span class="token at operator">@</span><span class="token function">db</span></span><span class="token punctuation">.</span><span class="token function">VarChar</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span>
  task_id    Int
  created_at DateTime @<span class="token keyword">default</span><span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token decorator"><span class="token at operator">@</span><span class="token function">db</span></span><span class="token punctuation">.</span><span class="token function">Timestamp</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>
  tasks      tasks    <span class="token decorator"><span class="token at operator">@</span><span class="token function">relation</span></span><span class="token punctuation">(</span>fields<span class="token operator">:</span> <span class="token punctuation">[</span>task_id<span class="token punctuation">]</span><span class="token punctuation">,</span> references<span class="token operator">:</span> <span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">,</span> onDelete<span class="token operator">:</span> Cascade<span class="token punctuation">)</span>

  @<span class="token decorator"><span class="token at operator">@</span><span class="token function">index</span></span><span class="token punctuation">(</span><span class="token punctuation">[</span>task_id<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

model grants <span class="token punctuation">{</span>
  role_id       Int
  permission_id Int
  created_at    DateTime    @<span class="token keyword">default</span><span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token decorator"><span class="token at operator">@</span><span class="token function">db</span></span><span class="token punctuation">.</span><span class="token function">Timestamp</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>
  permissions   permissions <span class="token decorator"><span class="token at operator">@</span><span class="token function">relation</span></span><span class="token punctuation">(</span>fields<span class="token operator">:</span> <span class="token punctuation">[</span>permission_id<span class="token punctuation">]</span><span class="token punctuation">,</span> references<span class="token operator">:</span> <span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">,</span> onDelete<span class="token operator">:</span> Cascade<span class="token punctuation">)</span>
  roles         roles       <span class="token decorator"><span class="token at operator">@</span><span class="token function">relation</span></span><span class="token punctuation">(</span>fields<span class="token operator">:</span> <span class="token punctuation">[</span>role_id<span class="token punctuation">]</span><span class="token punctuation">,</span> references<span class="token operator">:</span> <span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">,</span> onDelete<span class="token operator">:</span> Cascade<span class="token punctuation">)</span>

  @<span class="token decorator"><span class="token at operator">@</span><span class="token function">unique</span></span><span class="token punctuation">(</span><span class="token punctuation">[</span>role_id<span class="token punctuation">,</span> permission_id<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

model labels <span class="token punctuation">{</span>
  id    Int    <span class="token decorator"><span class="token at operator">@</span><span class="token function">id</span></span> @<span class="token keyword">default</span><span class="token punctuation">(</span><span class="token function">autoincrement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  name  String <span class="token decorator"><span class="token at operator">@</span><span class="token function">unique</span></span> <span class="token decorator"><span class="token at operator">@</span><span class="token function">db</span></span><span class="token punctuation">.</span><span class="token function">VarChar</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span>
  color String <span class="token decorator"><span class="token at operator">@</span><span class="token function">db</span></span><span class="token punctuation">.</span><span class="token function">VarChar</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span>
  tags  tags<span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

model members <span class="token punctuation">{</span>
  id           Int            <span class="token decorator"><span class="token at operator">@</span><span class="token function">id</span></span> @<span class="token keyword">default</span><span class="token punctuation">(</span><span class="token function">autoincrement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  user_id      Int
  project_id   Int
  role_id      Int
  created_at   DateTime       @<span class="token keyword">default</span><span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token decorator"><span class="token at operator">@</span><span class="token function">db</span></span><span class="token punctuation">.</span><span class="token function">Timestamp</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>
  updated_at   DateTime<span class="token operator">?</span>      <span class="token decorator"><span class="token at operator">@</span><span class="token function">db</span></span><span class="token punctuation">.</span><span class="token function">Timestamp</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>
  projects     projects       <span class="token decorator"><span class="token at operator">@</span><span class="token function">relation</span></span><span class="token punctuation">(</span>fields<span class="token operator">:</span> <span class="token punctuation">[</span>project_id<span class="token punctuation">]</span><span class="token punctuation">,</span> references<span class="token operator">:</span> <span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">,</span> onDelete<span class="token operator">:</span> Cascade<span class="token punctuation">)</span>
  roles        roles          <span class="token decorator"><span class="token at operator">@</span><span class="token function">relation</span></span><span class="token punctuation">(</span>fields<span class="token operator">:</span> <span class="token punctuation">[</span>role_id<span class="token punctuation">]</span><span class="token punctuation">,</span> references<span class="token operator">:</span> <span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">)</span>
  users        users          <span class="token decorator"><span class="token at operator">@</span><span class="token function">relation</span></span><span class="token punctuation">(</span>fields<span class="token operator">:</span> <span class="token punctuation">[</span>user_id<span class="token punctuation">]</span><span class="token punctuation">,</span> references<span class="token operator">:</span> <span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">,</span> onDelete<span class="token operator">:</span> Cascade<span class="token punctuation">)</span>
  participants participants<span class="token punctuation">[</span><span class="token punctuation">]</span>

  @<span class="token decorator"><span class="token at operator">@</span><span class="token function">unique</span></span><span class="token punctuation">(</span><span class="token punctuation">[</span>user_id<span class="token punctuation">,</span> project_id<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

model messages <span class="token punctuation">{</span>
  id            Int             <span class="token decorator"><span class="token at operator">@</span><span class="token function">id</span></span> @<span class="token keyword">default</span><span class="token punctuation">(</span><span class="token function">autoincrement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  content       String          <span class="token decorator"><span class="token at operator">@</span><span class="token function">db</span></span><span class="token punctuation">.</span><span class="token function">VarChar</span><span class="token punctuation">(</span><span class="token number">240</span><span class="token punctuation">)</span>
  created_at    DateTime        @<span class="token keyword">default</span><span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token decorator"><span class="token at operator">@</span><span class="token function">db</span></span><span class="token punctuation">.</span><span class="token function">Timestamp</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>
  sheduled_at   DateTime        <span class="token decorator"><span class="token at operator">@</span><span class="token function">db</span></span><span class="token punctuation">.</span><span class="token function">Timestamp</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>
  notifications notifications<span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

model notifications <span class="token punctuation">{</span>
  user_id    Int
  message_id Int
  messages   messages <span class="token decorator"><span class="token at operator">@</span><span class="token function">relation</span></span><span class="token punctuation">(</span>fields<span class="token operator">:</span> <span class="token punctuation">[</span>message_id<span class="token punctuation">]</span><span class="token punctuation">,</span> references<span class="token operator">:</span> <span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">,</span> onDelete<span class="token operator">:</span> Cascade<span class="token punctuation">)</span>
  users      users    <span class="token decorator"><span class="token at operator">@</span><span class="token function">relation</span></span><span class="token punctuation">(</span>fields<span class="token operator">:</span> <span class="token punctuation">[</span>user_id<span class="token punctuation">]</span><span class="token punctuation">,</span> references<span class="token operator">:</span> <span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">,</span> onDelete<span class="token operator">:</span> Cascade<span class="token punctuation">)</span>

  @<span class="token decorator"><span class="token at operator">@</span><span class="token function">unique</span></span><span class="token punctuation">(</span><span class="token punctuation">[</span>user_id<span class="token punctuation">,</span> message_id<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

model participants <span class="token punctuation">{</span>
  id         Int              <span class="token decorator"><span class="token at operator">@</span><span class="token function">id</span></span> @<span class="token keyword">default</span><span class="token punctuation">(</span><span class="token function">autoincrement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  member_id  Int
  task_id    Int
  role       participant_role
  created_at DateTime         @<span class="token keyword">default</span><span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token decorator"><span class="token at operator">@</span><span class="token function">db</span></span><span class="token punctuation">.</span><span class="token function">Timestamp</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>
  members    members          <span class="token decorator"><span class="token at operator">@</span><span class="token function">relation</span></span><span class="token punctuation">(</span>fields<span class="token operator">:</span> <span class="token punctuation">[</span>member_id<span class="token punctuation">]</span><span class="token punctuation">,</span> references<span class="token operator">:</span> <span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">,</span> onDelete<span class="token operator">:</span> Cascade<span class="token punctuation">)</span>
  tasks      tasks            <span class="token decorator"><span class="token at operator">@</span><span class="token function">relation</span></span><span class="token punctuation">(</span>fields<span class="token operator">:</span> <span class="token punctuation">[</span>task_id<span class="token punctuation">]</span><span class="token punctuation">,</span> references<span class="token operator">:</span> <span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">,</span> onDelete<span class="token operator">:</span> Cascade<span class="token punctuation">)</span>
  reviews    reviews<span class="token punctuation">[</span><span class="token punctuation">]</span>

  @<span class="token decorator"><span class="token at operator">@</span><span class="token function">unique</span></span><span class="token punctuation">(</span><span class="token punctuation">[</span>member_id<span class="token punctuation">,</span> task_id<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

model permissions <span class="token punctuation">{</span>
  id         Int      <span class="token decorator"><span class="token at operator">@</span><span class="token function">id</span></span> @<span class="token keyword">default</span><span class="token punctuation">(</span><span class="token function">autoincrement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  rule       String   <span class="token decorator"><span class="token at operator">@</span><span class="token function">unique</span></span> <span class="token decorator"><span class="token at operator">@</span><span class="token function">db</span></span><span class="token punctuation">.</span><span class="token function">VarChar</span><span class="token punctuation">(</span><span class="token number">45</span><span class="token punctuation">)</span>
  created_at DateTime @<span class="token keyword">default</span><span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token decorator"><span class="token at operator">@</span><span class="token function">db</span></span><span class="token punctuation">.</span><span class="token function">Timestamp</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>
  grants     grants<span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

model projects <span class="token punctuation">{</span>
  id          Int            <span class="token decorator"><span class="token at operator">@</span><span class="token function">id</span></span> @<span class="token keyword">default</span><span class="token punctuation">(</span><span class="token function">autoincrement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  title       String         <span class="token decorator"><span class="token at operator">@</span><span class="token function">unique</span></span> <span class="token decorator"><span class="token at operator">@</span><span class="token function">db</span></span><span class="token punctuation">.</span><span class="token function">VarChar</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span>
  status      project_status @<span class="token keyword">default</span><span class="token punctuation">(</span>inactive<span class="token punctuation">)</span>
  start_date  DateTime       <span class="token decorator"><span class="token at operator">@</span><span class="token function">db</span></span><span class="token punctuation">.</span><span class="token function">Timestamp</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>
  end_date    DateTime<span class="token operator">?</span>      <span class="token decorator"><span class="token at operator">@</span><span class="token function">db</span></span><span class="token punctuation">.</span><span class="token function">Timestamp</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>
  created_at  DateTime       @<span class="token keyword">default</span><span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token decorator"><span class="token at operator">@</span><span class="token function">db</span></span><span class="token punctuation">.</span><span class="token function">Timestamp</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>
  updated_at  DateTime<span class="token operator">?</span>      <span class="token decorator"><span class="token at operator">@</span><span class="token function">db</span></span><span class="token punctuation">.</span><span class="token function">Timestamp</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>
  logo        String<span class="token operator">?</span>        <span class="token decorator"><span class="token at operator">@</span><span class="token function">db</span></span><span class="token punctuation">.</span><span class="token function">VarChar</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span>
  description String<span class="token operator">?</span>        <span class="token decorator"><span class="token at operator">@</span><span class="token function">db</span></span><span class="token punctuation">.</span><span class="token function">VarChar</span><span class="token punctuation">(</span><span class="token number">4000</span><span class="token punctuation">)</span>
  members     members<span class="token punctuation">[</span><span class="token punctuation">]</span>
  tasks       tasks<span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

model reviews <span class="token punctuation">{</span>
  id             Int          <span class="token decorator"><span class="token at operator">@</span><span class="token function">id</span></span> @<span class="token keyword">default</span><span class="token punctuation">(</span><span class="token function">autoincrement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  task_id        Int
  participant_id Int
  replied_to     Int<span class="token operator">?</span>
  created_at     DateTime     @<span class="token keyword">default</span><span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token decorator"><span class="token at operator">@</span><span class="token function">db</span></span><span class="token punctuation">.</span><span class="token function">Timestamp</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>
  updated_at     DateTime<span class="token operator">?</span>    <span class="token decorator"><span class="token at operator">@</span><span class="token function">db</span></span><span class="token punctuation">.</span><span class="token function">Timestamp</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>
  content        String       <span class="token decorator"><span class="token at operator">@</span><span class="token function">db</span></span><span class="token punctuation">.</span><span class="token function">VarChar</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span>
  participants   participants <span class="token decorator"><span class="token at operator">@</span><span class="token function">relation</span></span><span class="token punctuation">(</span>fields<span class="token operator">:</span> <span class="token punctuation">[</span>participant_id<span class="token punctuation">]</span><span class="token punctuation">,</span> references<span class="token operator">:</span> <span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">,</span> onDelete<span class="token operator">:</span> Cascade<span class="token punctuation">)</span>
  reviews        reviews<span class="token operator">?</span>     <span class="token decorator"><span class="token at operator">@</span><span class="token function">relation</span></span><span class="token punctuation">(</span><span class="token string">&quot;reviewsToreviews&quot;</span><span class="token punctuation">,</span> fields<span class="token operator">:</span> <span class="token punctuation">[</span>replied_to<span class="token punctuation">]</span><span class="token punctuation">,</span> references<span class="token operator">:</span> <span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">,</span> onDelete<span class="token operator">:</span> Cascade<span class="token punctuation">)</span>
  other_reviews  reviews<span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token decorator"><span class="token at operator">@</span><span class="token function">relation</span></span><span class="token punctuation">(</span><span class="token string">&quot;reviewsToreviews&quot;</span><span class="token punctuation">)</span>
  tasks          tasks        <span class="token decorator"><span class="token at operator">@</span><span class="token function">relation</span></span><span class="token punctuation">(</span>fields<span class="token operator">:</span> <span class="token punctuation">[</span>task_id<span class="token punctuation">]</span><span class="token punctuation">,</span> references<span class="token operator">:</span> <span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">,</span> onDelete<span class="token operator">:</span> Cascade<span class="token punctuation">)</span>

  @<span class="token decorator"><span class="token at operator">@</span><span class="token function">index</span></span><span class="token punctuation">(</span><span class="token punctuation">[</span>task_id<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

model roles <span class="token punctuation">{</span>
  id      Int       <span class="token decorator"><span class="token at operator">@</span><span class="token function">id</span></span> @<span class="token keyword">default</span><span class="token punctuation">(</span><span class="token function">autoincrement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  name    String    <span class="token decorator"><span class="token at operator">@</span><span class="token function">unique</span></span> <span class="token decorator"><span class="token at operator">@</span><span class="token function">db</span></span><span class="token punctuation">.</span><span class="token function">VarChar</span><span class="token punctuation">(</span><span class="token number">45</span><span class="token punctuation">)</span>
  grants  grants<span class="token punctuation">[</span><span class="token punctuation">]</span>
  members members<span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

model tags <span class="token punctuation">{</span>
  label_id Int
  task_id  Int
  labels   labels <span class="token decorator"><span class="token at operator">@</span><span class="token function">relation</span></span><span class="token punctuation">(</span>fields<span class="token operator">:</span> <span class="token punctuation">[</span>label_id<span class="token punctuation">]</span><span class="token punctuation">,</span> references<span class="token operator">:</span> <span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">,</span> onDelete<span class="token operator">:</span> Cascade<span class="token punctuation">)</span>
  tasks    tasks  <span class="token decorator"><span class="token at operator">@</span><span class="token function">relation</span></span><span class="token punctuation">(</span>fields<span class="token operator">:</span> <span class="token punctuation">[</span>task_id<span class="token punctuation">]</span><span class="token punctuation">,</span> references<span class="token operator">:</span> <span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">,</span> onDelete<span class="token operator">:</span> Cascade<span class="token punctuation">)</span>

  @<span class="token decorator"><span class="token at operator">@</span><span class="token function">unique</span></span><span class="token punctuation">(</span><span class="token punctuation">[</span>label_id<span class="token punctuation">,</span> task_id<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

model tasks <span class="token punctuation">{</span>
  id           Int            <span class="token decorator"><span class="token at operator">@</span><span class="token function">id</span></span> @<span class="token keyword">default</span><span class="token punctuation">(</span><span class="token function">autoincrement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  title        String         <span class="token decorator"><span class="token at operator">@</span><span class="token function">db</span></span><span class="token punctuation">.</span><span class="token function">VarChar</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span>
  status       String         <span class="token decorator"><span class="token at operator">@</span><span class="token function">db</span></span><span class="token punctuation">.</span><span class="token function">VarChar</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span>
  project_id   Int
  description  String<span class="token operator">?</span>        <span class="token decorator"><span class="token at operator">@</span><span class="token function">db</span></span><span class="token punctuation">.</span><span class="token function">VarChar</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span>
  deadline     DateTime<span class="token operator">?</span>      <span class="token decorator"><span class="token at operator">@</span><span class="token function">db</span></span><span class="token punctuation">.</span><span class="token function">Timestamp</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>
  created_at   DateTime       @<span class="token keyword">default</span><span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token decorator"><span class="token at operator">@</span><span class="token function">db</span></span><span class="token punctuation">.</span><span class="token function">Timestamp</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>
  updated_at   DateTime<span class="token operator">?</span>      <span class="token decorator"><span class="token at operator">@</span><span class="token function">db</span></span><span class="token punctuation">.</span><span class="token function">Timestamp</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>
  attachments  attachments<span class="token punctuation">[</span><span class="token punctuation">]</span>
  participants participants<span class="token punctuation">[</span><span class="token punctuation">]</span>
  reviews      reviews<span class="token punctuation">[</span><span class="token punctuation">]</span>
  tags         tags<span class="token punctuation">[</span><span class="token punctuation">]</span>
  projects     projects       <span class="token decorator"><span class="token at operator">@</span><span class="token function">relation</span></span><span class="token punctuation">(</span>fields<span class="token operator">:</span> <span class="token punctuation">[</span>project_id<span class="token punctuation">]</span><span class="token punctuation">,</span> references<span class="token operator">:</span> <span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">,</span> onDelete<span class="token operator">:</span> Cascade<span class="token punctuation">)</span>

  @<span class="token decorator"><span class="token at operator">@</span><span class="token function">index</span></span><span class="token punctuation">(</span><span class="token punctuation">[</span>project_id<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

model users <span class="token punctuation">{</span>
  id            Int              <span class="token decorator"><span class="token at operator">@</span><span class="token function">id</span></span> @<span class="token keyword">default</span><span class="token punctuation">(</span><span class="token function">autoincrement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  login         String           <span class="token decorator"><span class="token at operator">@</span><span class="token function">unique</span></span> <span class="token decorator"><span class="token at operator">@</span><span class="token function">db</span></span><span class="token punctuation">.</span><span class="token function">VarChar</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span>
  password      String           <span class="token decorator"><span class="token at operator">@</span><span class="token function">db</span></span><span class="token punctuation">.</span><span class="token function">VarChar</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span>
  email         String<span class="token operator">?</span>          <span class="token decorator"><span class="token at operator">@</span><span class="token function">unique</span></span> <span class="token decorator"><span class="token at operator">@</span><span class="token function">db</span></span><span class="token punctuation">.</span><span class="token function">VarChar</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">)</span>
  phone         String<span class="token operator">?</span>          <span class="token decorator"><span class="token at operator">@</span><span class="token function">unique</span></span> <span class="token decorator"><span class="token at operator">@</span><span class="token function">db</span></span><span class="token punctuation">.</span><span class="token function">VarChar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
  avatar        String<span class="token operator">?</span>          <span class="token decorator"><span class="token at operator">@</span><span class="token function">db</span></span><span class="token punctuation">.</span><span class="token function">VarChar</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span>
  system_role   user_system_role
  created_at    DateTime         @<span class="token keyword">default</span><span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token decorator"><span class="token at operator">@</span><span class="token function">db</span></span><span class="token punctuation">.</span><span class="token function">Timestamp</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>
  updated_at    DateTime<span class="token operator">?</span>        <span class="token decorator"><span class="token at operator">@</span><span class="token function">db</span></span><span class="token punctuation">.</span><span class="token function">Timestamp</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>
  members       members<span class="token punctuation">[</span><span class="token punctuation">]</span>
  notifications notifications<span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token keyword">enum</span> participant_role <span class="token punctuation">{</span>
  author
  assignee
  reviewer
  participant
<span class="token punctuation">}</span>

<span class="token keyword">enum</span> project_status <span class="token punctuation">{</span>
  active
  inactive
<span class="token punctuation">}</span>

<span class="token keyword">enum</span> user_system_role <span class="token punctuation">{</span>
  user
  admin
<span class="token punctuation">}</span>
</code></pre></div><h3 id="головнии-фаил-програми"><a href="#головнии-фаил-програми" class="header-anchor">#</a> Головний файл програми</h3> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> ValidationPipe <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nestjs/common'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> NestFactory <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nestjs/core'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> AppModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./app.module'</span><span class="token punctuation">;</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">bootstrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">await</span> NestFactory<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>AppModule<span class="token punctuation">)</span><span class="token punctuation">;</span>
  app<span class="token punctuation">.</span><span class="token function">useGlobalPipes</span><span class="token punctuation">(</span>
    <span class="token keyword">new</span> <span class="token class-name">ValidationPipe</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      whitelist<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">bootstrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="головнии-модуль-програми"><a href="#головнии-модуль-програми" class="header-anchor">#</a> Головний модуль програми</h3> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Module <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nestjs/common'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ProjectModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./project/project.module'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> UserModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./user/user.module'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> PrismaModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./prisma/prisma.module'</span><span class="token punctuation">;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Module</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  imports<span class="token operator">:</span> <span class="token punctuation">[</span>ProjectModule<span class="token punctuation">,</span> UserModule<span class="token punctuation">,</span> PrismaModule<span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">AppModule</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><h3 id="валідатор-isunique"><a href="#валідатор-isunique" class="header-anchor">#</a> Валідатор IsUnique</h3> <div class="language-typescript extra-class"><pre class="language-typescript"><code>  <span class="token keyword">import</span> <span class="token punctuation">{</span>
  registerDecorator<span class="token punctuation">,</span>
  ValidationOptions<span class="token punctuation">,</span>
  ValidationArguments<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'class-validator'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> PrismaService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../../prisma/prisma.service'</span><span class="token punctuation">;</span>

<span class="token keyword">interface</span> <span class="token class-name">IsUnique</span> <span class="token punctuation">{</span>
  entity<span class="token operator">:</span> <span class="token string">'projects'</span> <span class="token operator">|</span> <span class="token string">'users'</span><span class="token punctuation">;</span>
  field<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">IsUnique</span><span class="token punctuation">(</span>
  options<span class="token operator">:</span> IsUnique<span class="token punctuation">,</span>
  validationOptions<span class="token operator">?</span><span class="token operator">:</span> ValidationOptions<span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token operator">:</span> PropertyDecorator <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>object<span class="token operator">:</span> object<span class="token punctuation">,</span> propertyName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">registerDecorator</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      name<span class="token operator">:</span> <span class="token string">'isUnique'</span><span class="token punctuation">,</span>
      target<span class="token operator">:</span> object<span class="token punctuation">.</span>constructor<span class="token punctuation">,</span>
      propertyName<span class="token operator">:</span> propertyName<span class="token punctuation">,</span>
      options<span class="token operator">:</span> validationOptions<span class="token punctuation">,</span>
      validator<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token keyword">async</span> <span class="token function">validate</span><span class="token punctuation">(</span>value<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> args<span class="token operator">:</span> ValidationArguments<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">const</span> prismaService <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PrismaService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

          <span class="token keyword">const</span> whereClause <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token punctuation">[</span>options<span class="token punctuation">.</span>field<span class="token punctuation">]</span><span class="token operator">:</span> value<span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">;</span>

          <span class="token keyword">const</span> existingEntity <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token punctuation">(</span>
            prismaService<span class="token punctuation">[</span>options<span class="token punctuation">.</span>entity<span class="token punctuation">]</span> <span class="token keyword">as</span> <span class="token builtin">any</span>
          <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">findUnique</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            where<span class="token operator">:</span> whereClause<span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

          <span class="token keyword">if</span> <span class="token punctuation">(</span>existingEntity<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
          <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function-variable function">defaultMessage</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> value <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
          <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">The </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>options<span class="token punctuation">.</span>field<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> &quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot; is not unique.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="модуль-для-контролю-запитів-до-користувачів"><a href="#модуль-для-контролю-запитів-до-користувачів" class="header-anchor">#</a> Модуль для контролю запитів до користувачів</h3> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Module <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nestjs/common'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> UserController <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./user.controller'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> UserService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./user.service'</span><span class="token punctuation">;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Module</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  controllers<span class="token operator">:</span> <span class="token punctuation">[</span>UserController<span class="token punctuation">]</span><span class="token punctuation">,</span>
  providers<span class="token operator">:</span> <span class="token punctuation">[</span>UserService<span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">UserModule</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><h3 id="dto-для-створення-користувача"><a href="#dto-для-створення-користувача" class="header-anchor">#</a> DTO для створення користувача</h3> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>
  IsEmail<span class="token punctuation">,</span>
  IsEnum<span class="token punctuation">,</span>
  IsNotEmpty<span class="token punctuation">,</span>
  IsOptional<span class="token punctuation">,</span>
  IsString<span class="token punctuation">,</span>
  MaxLength<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'class-validator'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> user_system_role <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'node_modules/.prisma/client/index'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> IsUnique <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'src/shared/validation/is-unique'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">UserCreateDto</span> <span class="token punctuation">{</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">IsNotEmpty</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">IsString</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">IsUnique</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span> entity<span class="token operator">:</span> <span class="token string">'users'</span><span class="token punctuation">,</span> field<span class="token operator">:</span> <span class="token string">'login'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">MaxLength</span></span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span>
  login<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">IsNotEmpty</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">IsString</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">MaxLength</span></span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span>
  password<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">IsOptional</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">IsEmail</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">IsUnique</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span> entity<span class="token operator">:</span> <span class="token string">'users'</span><span class="token punctuation">,</span> field<span class="token operator">:</span> <span class="token string">'email'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">MaxLength</span></span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">)</span>
  email<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">IsOptional</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">IsString</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">IsUnique</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span> entity<span class="token operator">:</span> <span class="token string">'users'</span><span class="token punctuation">,</span> field<span class="token operator">:</span> <span class="token string">'phone'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">MaxLength</span></span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
  phone<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">IsOptional</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">IsString</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">MaxLength</span></span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span>
  avatar<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">IsOptional</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">IsEnum</span></span><span class="token punctuation">(</span>user_system_role<span class="token punctuation">)</span>
  system_role<span class="token operator">?</span><span class="token operator">:</span> user_system_role<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="dto-для-оновлення-даних-користувача"><a href="#dto-для-оновлення-даних-користувача" class="header-anchor">#</a> DTO для оновлення даних користувача</h3> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>
  IsEmail<span class="token punctuation">,</span>
  IsEnum<span class="token punctuation">,</span>
  IsOptional<span class="token punctuation">,</span>
  IsString<span class="token punctuation">,</span>
  MaxLength<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'class-validator'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> user_system_role <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'node_modules/.prisma/client/index'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">UserUpdateDto</span> <span class="token punctuation">{</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">IsOptional</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">IsString</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">MaxLength</span></span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span>
  login<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">IsOptional</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">IsString</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">MaxLength</span></span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span>
  password<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">IsOptional</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">IsEmail</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">MaxLength</span></span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">)</span>
  email<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">IsOptional</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">IsString</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">MaxLength</span></span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
  phone<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">IsOptional</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">IsString</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">MaxLength</span></span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span>
  avatar<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">IsOptional</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">IsEnum</span></span><span class="token punctuation">(</span>user_system_role<span class="token punctuation">)</span>
  system_role<span class="token operator">?</span><span class="token operator">:</span> user_system_role<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="контроллер-запитів-до-користувачів"><a href="#контроллер-запитів-до-користувачів" class="header-anchor">#</a> Контроллер запитів до користувачів</h3> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>
  Body<span class="token punctuation">,</span>
  Controller<span class="token punctuation">,</span>
  Delete<span class="token punctuation">,</span>
  Get<span class="token punctuation">,</span>
  Param<span class="token punctuation">,</span>
  ParseIntPipe<span class="token punctuation">,</span>
  Patch<span class="token punctuation">,</span>
  Post<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nestjs/common'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> UserService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./user.service'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> UserCreateDto<span class="token punctuation">,</span> UserUpdateDto <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./dto'</span><span class="token punctuation">;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Controller</span></span><span class="token punctuation">(</span><span class="token string">'users'</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">UserController</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token keyword">private</span> userService<span class="token operator">:</span> UserService<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Post</span></span><span class="token punctuation">(</span><span class="token string">'create'</span><span class="token punctuation">)</span>
  <span class="token function">create</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">Body</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> dto<span class="token operator">:</span> UserCreateDto<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>userService<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>dto<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Get</span></span><span class="token punctuation">(</span><span class="token string">':id'</span><span class="token punctuation">)</span>
  <span class="token function">getSingleUser</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">Param</span></span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">,</span> ParseIntPipe<span class="token punctuation">)</span> userId<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>userService<span class="token punctuation">.</span><span class="token function">getSingleUser</span><span class="token punctuation">(</span>userId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> user<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Get</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">getAllUsers</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> users <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>userService<span class="token punctuation">.</span><span class="token function">getAllUsers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> users<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Patch</span></span><span class="token punctuation">(</span><span class="token string">':id'</span><span class="token punctuation">)</span>
  <span class="token function">update</span><span class="token punctuation">(</span>
    <span class="token decorator"><span class="token at operator">@</span><span class="token function">Param</span></span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">,</span> ParseIntPipe<span class="token punctuation">)</span> userId<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span>
    <span class="token decorator"><span class="token at operator">@</span><span class="token function">Body</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> dto<span class="token operator">:</span> UserUpdateDto<span class="token punctuation">,</span>
  <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>userService<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>userId<span class="token punctuation">,</span> dto<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Delete</span></span><span class="token punctuation">(</span><span class="token string">':id'</span><span class="token punctuation">)</span>
  <span class="token keyword">delete</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">Param</span></span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">,</span> ParseIntPipe<span class="token punctuation">)</span> userId<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>userService<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>userId<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="сервіс-для-обробки-запитів-до-користувачів"><a href="#сервіс-для-обробки-запитів-до-користувачів" class="header-anchor">#</a> Сервіс для обробки запитів до користувачів</h3> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>
  ForbiddenException<span class="token punctuation">,</span>
  Injectable<span class="token punctuation">,</span>
  NotFoundException<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nestjs/common'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> PrismaService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'src/prisma/prisma.service'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> PrismaClientKnownRequestError <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@prisma/client/runtime/library'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> UserCreateDto<span class="token punctuation">,</span> UserUpdateDto <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./dto'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> argon <span class="token keyword">from</span> <span class="token string">'argon2'</span><span class="token punctuation">;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Injectable</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">UserService</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token keyword">private</span> prisma<span class="token operator">:</span> PrismaService<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token keyword">async</span> <span class="token function">create</span><span class="token punctuation">(</span>dto<span class="token operator">:</span> UserCreateDto<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> hash <span class="token operator">=</span> <span class="token keyword">await</span> argon<span class="token punctuation">.</span><span class="token function">hash</span><span class="token punctuation">(</span>dto<span class="token punctuation">.</span>password<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>prisma<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      data<span class="token operator">:</span> <span class="token punctuation">{</span>
        login<span class="token operator">:</span> dto<span class="token punctuation">.</span>login<span class="token punctuation">,</span>
        password<span class="token operator">:</span> hash<span class="token punctuation">,</span>
        email<span class="token operator">:</span> dto<span class="token punctuation">.</span>email<span class="token punctuation">,</span>
        phone<span class="token operator">:</span> dto<span class="token punctuation">.</span>phone<span class="token punctuation">,</span>
        avatar<span class="token operator">:</span> dto<span class="token punctuation">.</span>avatar<span class="token punctuation">,</span>
        system_role<span class="token operator">:</span> dto<span class="token punctuation">.</span>system_role<span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> user<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">async</span> <span class="token function">getSingleUser</span><span class="token punctuation">(</span>userId<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">findUser</span><span class="token punctuation">(</span>userId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> userProjects <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>prisma<span class="token punctuation">.</span>members<span class="token punctuation">.</span><span class="token function">findMany</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      where<span class="token operator">:</span> <span class="token punctuation">{</span>
        user_id<span class="token operator">:</span> userId<span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      select<span class="token operator">:</span> <span class="token punctuation">{</span>
        projects<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    user<span class="token punctuation">[</span><span class="token string">'projects'</span><span class="token punctuation">]</span> <span class="token operator">=</span> userProjects<span class="token punctuation">;</span>
    <span class="token keyword">return</span> user<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">async</span> <span class="token function">getAllUsers</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> users <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>prisma<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">findMany</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> users<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">async</span> <span class="token function">update</span><span class="token punctuation">(</span>userId<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> dto<span class="token operator">:</span> UserUpdateDto<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">findUser</span><span class="token punctuation">(</span>userId<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">updateUser</span><span class="token punctuation">(</span>userId<span class="token punctuation">,</span> dto<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> user<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>error <span class="token keyword">instanceof</span> <span class="token class-name">PrismaClientKnownRequestError</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">.</span>code <span class="token operator">==</span> <span class="token string">'P2002'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">ForbiddenException</span><span class="token punctuation">(</span><span class="token string">'Some of fields are not unique'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">async</span> <span class="token keyword">delete</span><span class="token punctuation">(</span>userId<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">findUser</span><span class="token punctuation">(</span>userId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>prisma<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      where<span class="token operator">:</span> <span class="token punctuation">{</span>
        id<span class="token operator">:</span> userId<span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token string">'User is successfully deleted'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">private</span> <span class="token keyword">async</span> <span class="token function">findUser</span><span class="token punctuation">(</span>userId<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>prisma<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">findUnique</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      where<span class="token operator">:</span> <span class="token punctuation">{</span>
        id<span class="token operator">:</span> userId<span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>user<span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">NotFoundException</span><span class="token punctuation">(</span><span class="token string">'No such user'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> user<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">private</span> <span class="token keyword">async</span> <span class="token function">updateUser</span><span class="token punctuation">(</span>userId<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> dto<span class="token operator">:</span> UserUpdateDto<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>dto<span class="token punctuation">.</span>password<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      dto<span class="token punctuation">.</span>password <span class="token operator">=</span> <span class="token keyword">await</span> argon<span class="token punctuation">.</span><span class="token function">hash</span><span class="token punctuation">(</span>dto<span class="token punctuation">.</span>password<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">const</span> updUser <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>prisma<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      where<span class="token operator">:</span> <span class="token punctuation">{</span>
        id<span class="token operator">:</span> userId<span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      data<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token operator">...</span>dto<span class="token punctuation">,</span>
        updated_at<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> updUser<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="модуль-для-контролю-запитів-до-проєктів"><a href="#модуль-для-контролю-запитів-до-проєктів" class="header-anchor">#</a> Модуль для контролю запитів до проєктів</h3> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Module <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nestjs/common'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ProjectController <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./project.controller'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ProjectService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./project.service'</span><span class="token punctuation">;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Module</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  controllers<span class="token operator">:</span> <span class="token punctuation">[</span>ProjectController<span class="token punctuation">]</span><span class="token punctuation">,</span>
  providers<span class="token operator">:</span> <span class="token punctuation">[</span>ProjectService<span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">ProjectModule</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><h3 id="dto-для-створення-проєкту"><a href="#dto-для-створення-проєкту" class="header-anchor">#</a> DTO для створення проєкту</h3> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>
  IsDateString<span class="token punctuation">,</span>
  IsEnum<span class="token punctuation">,</span>
  IsNotEmpty<span class="token punctuation">,</span>
  IsOptional<span class="token punctuation">,</span>
  IsString<span class="token punctuation">,</span>
  MaxLength<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'class-validator'</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> project_status <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'node_modules/.prisma/client/index'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> IsUnique <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'src/shared/validation/is-unique'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">ProjectCreateDto</span> <span class="token punctuation">{</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">IsNotEmpty</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">IsString</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">IsUnique</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span> entity<span class="token operator">:</span> <span class="token string">'projects'</span><span class="token punctuation">,</span> field<span class="token operator">:</span> <span class="token string">'title'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">MaxLength</span></span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span>
  title<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">IsOptional</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">IsEnum</span></span><span class="token punctuation">(</span>project_status<span class="token punctuation">)</span>
  status<span class="token operator">?</span><span class="token operator">:</span> project_status<span class="token punctuation">;</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">IsNotEmpty</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">IsDateString</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  start_date<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">IsOptional</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">IsDateString</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  end_date<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">IsOptional</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">IsString</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">MaxLength</span></span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span>
  logo<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">IsOptional</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">IsString</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">MaxLength</span></span><span class="token punctuation">(</span><span class="token number">4000</span><span class="token punctuation">)</span>
  description<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="dto-для-оновлення-даних-проєкту"><a href="#dto-для-оновлення-даних-проєкту" class="header-anchor">#</a> DTO для оновлення даних проєкту</h3> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>
  IsDateString<span class="token punctuation">,</span>
  IsEnum<span class="token punctuation">,</span>
  IsOptional<span class="token punctuation">,</span>
  IsString<span class="token punctuation">,</span>
  MaxLength<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'class-validator'</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> project_status <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'node_modules/.prisma/client/index'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">ProjectUpdateDto</span> <span class="token punctuation">{</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">IsOptional</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">IsString</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">MaxLength</span></span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span>
  title<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">IsOptional</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">IsEnum</span></span><span class="token punctuation">(</span>project_status<span class="token punctuation">)</span>
  status<span class="token operator">?</span><span class="token operator">:</span> project_status<span class="token punctuation">;</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">IsOptional</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">IsDateString</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  start_date<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">IsOptional</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">IsDateString</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  end_date<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">IsOptional</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">IsString</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">MaxLength</span></span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span>
  logo<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">IsOptional</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">IsString</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">MaxLength</span></span><span class="token punctuation">(</span><span class="token number">4000</span><span class="token punctuation">)</span>
  description<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="контроллер-запитів-до-проєктів"><a href="#контроллер-запитів-до-проєктів" class="header-anchor">#</a> Контроллер запитів до проєктів</h3> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>
  Body<span class="token punctuation">,</span>
  Controller<span class="token punctuation">,</span>
  Delete<span class="token punctuation">,</span>
  Get<span class="token punctuation">,</span>
  Param<span class="token punctuation">,</span>
  ParseIntPipe<span class="token punctuation">,</span>
  Patch<span class="token punctuation">,</span>
  Post<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nestjs/common'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ProjectService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./project.service'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ProjectCreateDto<span class="token punctuation">,</span> ProjectUpdateDto <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./dto'</span><span class="token punctuation">;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Controller</span></span><span class="token punctuation">(</span><span class="token string">'projects'</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">ProjectController</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token keyword">private</span> projectService<span class="token operator">:</span> ProjectService<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Post</span></span><span class="token punctuation">(</span><span class="token string">'create'</span><span class="token punctuation">)</span>
  <span class="token function">create</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">Body</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> dto<span class="token operator">:</span> ProjectCreateDto<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>projectService<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>dto<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Get</span></span><span class="token punctuation">(</span><span class="token string">':id'</span><span class="token punctuation">)</span>
  <span class="token function">getSingleProject</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">Param</span></span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">,</span> ParseIntPipe<span class="token punctuation">)</span> projectId<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> project <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>projectService<span class="token punctuation">.</span><span class="token function">getSingleProject</span><span class="token punctuation">(</span>projectId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> project<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Get</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">getAllProjects</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> projects <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>projectService<span class="token punctuation">.</span><span class="token function">getAllProjects</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> projects<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Patch</span></span><span class="token punctuation">(</span><span class="token string">':id'</span><span class="token punctuation">)</span>
  <span class="token function">update</span><span class="token punctuation">(</span>
    <span class="token decorator"><span class="token at operator">@</span><span class="token function">Param</span></span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">,</span> ParseIntPipe<span class="token punctuation">)</span> projectId<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span>
    <span class="token decorator"><span class="token at operator">@</span><span class="token function">Body</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> dto<span class="token operator">:</span> ProjectUpdateDto<span class="token punctuation">,</span>
  <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>projectService<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>projectId<span class="token punctuation">,</span> dto<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Delete</span></span><span class="token punctuation">(</span><span class="token string">':id'</span><span class="token punctuation">)</span>
  <span class="token keyword">delete</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">Param</span></span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">,</span> ParseIntPipe<span class="token punctuation">)</span> projectId<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>projectService<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>projectId<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="сервіс-для-обробки-запитів-до-проєктів"><a href="#сервіс-для-обробки-запитів-до-проєктів" class="header-anchor">#</a> Сервіс для обробки запитів до проєктів</h3> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>
  ForbiddenException<span class="token punctuation">,</span>
  Injectable<span class="token punctuation">,</span>
  NotFoundException<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nestjs/common'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> PrismaService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'src/prisma/prisma.service'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ProjectCreateDto<span class="token punctuation">,</span> ProjectUpdateDto <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./dto'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> PrismaClientKnownRequestError <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@prisma/client/runtime/library'</span><span class="token punctuation">;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Injectable</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">ProjectService</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token keyword">private</span> prisma<span class="token operator">:</span> PrismaService<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token keyword">async</span> <span class="token function">create</span><span class="token punctuation">(</span>dto<span class="token operator">:</span> ProjectCreateDto<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> project <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>prisma<span class="token punctuation">.</span>projects<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      data<span class="token operator">:</span> <span class="token punctuation">{</span>
        title<span class="token operator">:</span> dto<span class="token punctuation">.</span>title<span class="token punctuation">,</span>
        status<span class="token operator">:</span> dto<span class="token punctuation">.</span>status<span class="token punctuation">,</span>
        start_date<span class="token operator">:</span> dto<span class="token punctuation">.</span>start_date <span class="token operator">?</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>dto<span class="token punctuation">.</span>start_date<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
        end_date<span class="token operator">:</span> dto<span class="token punctuation">.</span>end_date <span class="token operator">?</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>dto<span class="token punctuation">.</span>end_date<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
        logo<span class="token operator">:</span> dto<span class="token punctuation">.</span>logo<span class="token punctuation">,</span>
        description<span class="token operator">:</span> dto<span class="token punctuation">.</span>description<span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> project<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">async</span> <span class="token function">getSingleProject</span><span class="token punctuation">(</span>projectId<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> project <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">findProject</span><span class="token punctuation">(</span>projectId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> projectMembers <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>prisma<span class="token punctuation">.</span>members<span class="token punctuation">.</span><span class="token function">findMany</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      where<span class="token operator">:</span> <span class="token punctuation">{</span>
        project_id<span class="token operator">:</span> projectId<span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      select<span class="token operator">:</span> <span class="token punctuation">{</span>
        users<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    project<span class="token punctuation">[</span><span class="token string">'users'</span><span class="token punctuation">]</span> <span class="token operator">=</span> projectMembers<span class="token punctuation">;</span>
    <span class="token keyword">return</span> project<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">async</span> <span class="token function">getAllProjects</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> projects <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>prisma<span class="token punctuation">.</span>projects<span class="token punctuation">.</span><span class="token function">findMany</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> projects<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">async</span> <span class="token function">update</span><span class="token punctuation">(</span>projectId<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> dto<span class="token operator">:</span> ProjectUpdateDto<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">findProject</span><span class="token punctuation">(</span>projectId<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> updProject <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">updateProject</span><span class="token punctuation">(</span>projectId<span class="token punctuation">,</span> dto<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> updProject<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>error <span class="token keyword">instanceof</span> <span class="token class-name">PrismaClientKnownRequestError</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">.</span>code <span class="token operator">==</span> <span class="token string">'P2002'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">ForbiddenException</span><span class="token punctuation">(</span><span class="token string">'Title is not unique'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">async</span> <span class="token keyword">delete</span><span class="token punctuation">(</span>projectId<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">findProject</span><span class="token punctuation">(</span>projectId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>prisma<span class="token punctuation">.</span>projects<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      where<span class="token operator">:</span> <span class="token punctuation">{</span>
        id<span class="token operator">:</span> projectId<span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token string">'Project is successfully deleted'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">private</span> <span class="token keyword">async</span> <span class="token function">findProject</span><span class="token punctuation">(</span>projectId<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> project <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>prisma<span class="token punctuation">.</span>projects<span class="token punctuation">.</span><span class="token function">findUnique</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      where<span class="token operator">:</span> <span class="token punctuation">{</span>
        id<span class="token operator">:</span> projectId<span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>project<span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">NotFoundException</span><span class="token punctuation">(</span><span class="token string">'No such project'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> project<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">private</span> <span class="token keyword">async</span> <span class="token function">updateProject</span><span class="token punctuation">(</span>projectId<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> dto<span class="token operator">:</span> ProjectUpdateDto<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> updProject <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>prisma<span class="token punctuation">.</span>projects<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      where<span class="token operator">:</span> <span class="token punctuation">{</span>
        id<span class="token operator">:</span> projectId<span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      data<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token operator">...</span>dto<span class="token punctuation">,</span>
        updated_at<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> updProject<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Останнє оновлення:</span> <span class="time">12/11/2023, 12:37:44 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/database-coursework/design/" class="prev">
        Проектування інформаційного забезпечення
      </a></span> <span class="next"><a href="/database-coursework/test/">
        Тестування працездатності системи
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/database-coursework/assets/js/app.3c640ca0.js" defer></script><script src="/database-coursework/assets/js/2.84bc8c61.js" defer></script><script src="/database-coursework/assets/js/1.3844ea3f.js" defer></script><script src="/database-coursework/assets/js/38.2ca837a5.js" defer></script>
  </body>
</html>
